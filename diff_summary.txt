diff --git a/check_auth.php b/check_auth.php
index a525dd6..a4b1303 100644
--- a/check_auth.php
+++ b/check_auth.php
@@ -35,6 +35,22 @@ if (!isset($_SESSION['user_id'])) {
     }
 
     // If we are here, authentication failed
+    // Check if this is an API request (expects JSON)
+    $isApiRequest = (
+        isset($_GET['action']) || 
+        (isset($_SERVER['HTTP_ACCEPT']) && strpos($_SERVER['HTTP_ACCEPT'], 'application/json') !== false) ||
+        (isset($_SERVER['CONTENT_TYPE']) && strpos($_SERVER['CONTENT_TYPE'], 'application/json') !== false)
+    );
+    
+    if ($isApiRequest) {
+        // Return JSON error for API requests
+        header('Content-Type: application/json');
+        http_response_code(401);
+        echo json_encode(['success' => false, 'error' => 'Authentication required. Please log in.']);
+        exit;
+    }
+    
+    // Regular page request - redirect to login
     header('Location: login');
     exit;
 }
\ No newline at end of file
diff --git a/composer.json b/composer.json
new file mode 100644
index 0000000..3875f37
--- /dev/null
+++ b/composer.json
@@ -0,0 +1,15 @@
+{
+    "name": "tutormind/app",
+    "description": "TutorMind AI Learning Assistant",
+    "type": "project",
+    "require": {
+        "php": ">=7.4",
+        "erusev/parsedown": "^1.7",
+        "smalot/pdfparser": "^2.0",
+        "phpoffice/phpword": "^1.0",
+        "phpoffice/phppresentation": "^1.0"
+    },
+    "config": {
+        "optimize-autoloader": true
+    }
+}
diff --git a/login.html b/login.html
index 17e0cf5..12e38e4 100644
--- a/login.html
+++ b/login.html
@@ -1,5 +1,6 @@
 <!DOCTYPE html>
 <html lang="en">
+
 <head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
@@ -124,7 +125,7 @@
             border-color: var(--primary);
             box-shadow: 0 0 0 3px rgba(123, 63, 242, 0.2);
         }
-        
+
         .password-wrapper {
             position: relative;
         }
@@ -165,6 +166,7 @@
             text-decoration: none;
             font-weight: 500;
         }
+
         .forgot-password:hover {
             text-decoration: underline;
         }
@@ -186,7 +188,7 @@
             background-color: var(--primary-dark);
             transform: scale(1.02);
         }
-        
+
         .btn-login:active {
             transform: scale(0.98);
         }
@@ -231,7 +233,7 @@
             gap: 0.75rem;
             transition: background-color 0.2s ease;
         }
-        
+
         .btn-social img {
             width: 20px;
             height: 20px;
@@ -253,6 +255,7 @@
             font-weight: 600;
             text-decoration: none;
         }
+
         .login-footer a:hover {
             text-decoration: underline;
         }
@@ -288,39 +291,61 @@
         }
 
         .s1 {
-            width: 400px; height: 400px;
+            width: 400px;
+            height: 400px;
             background: rgba(255, 255, 255, 0.05);
-            top: -100px; left: -150px;
+            top: -100px;
+            left: -150px;
         }
+
         .s2 {
-            width: 150px; height: 150px;
+            width: 150px;
+            height: 150px;
             background: var(--cyan);
-            bottom: 5%; right: 10%;
+            bottom: 5%;
+            right: 10%;
             animation-duration: 12s;
         }
+
         .s3 {
-            width: 80px; height: 80px;
+            width: 80px;
+            height: 80px;
             background: var(--yellow);
-            top: 20%; right: 25%;
+            top: 20%;
+            right: 25%;
             animation-duration: 18s;
         }
+
         .s4 {
-            width: 250px; height: 250px;
+            width: 250px;
+            height: 250px;
             border: 4px solid rgba(255, 255, 255, 0.2);
-            bottom: -120px; left: 10%;
+            bottom: -120px;
+            left: 10%;
             animation-duration: 20s;
         }
+
         .s5 {
-            width: 50px; height: 50px;
+            width: 50px;
+            height: 50px;
             background: var(--secondary);
-            top: 15%; left: 30%;
+            top: 15%;
+            left: 30%;
             animation-duration: 10s;
         }
-        
+
         @keyframes float {
-            0% { transform: translateY(0px) rotate(0deg); }
-            50% { transform: translateY(-30px) rotate(180deg); }
-            100% { transform: translateY(0px) rotate(360deg); }
+            0% {
+                transform: translateY(0px) rotate(0deg);
+            }
+
+            50% {
+                transform: translateY(-30px) rotate(180deg);
+            }
+
+            100% {
+                transform: translateY(0px) rotate(360deg);
+            }
         }
 
         /* Responsive Design */
@@ -328,12 +353,54 @@
             .login-visual-container {
                 display: none;
             }
+
             .login-form-container {
                 flex-basis: 100%;
             }
         }
+
+        /* 720p Optimization */
+        @media (max-height: 800px) {
+            .login-form-container {
+                padding: 1rem 1.5rem;
+            }
+
+            .login-header {
+                margin-bottom: 1.5rem;
+            }
+
+            .login-header h1 {
+                font-size: 1.75rem;
+                margin-bottom: 0.25rem;
+            }
+
+            .auth-logo {
+                margin-bottom: 1rem;
+            }
+
+            .form-group {
+                margin-bottom: 1rem;
+            }
+
+            .form-group input {
+                padding: 0.6rem 0.9rem;
+            }
+
+            .form-options {
+                margin-bottom: 1.25rem;
+            }
+
+            .divider {
+                margin: 1.5rem 0;
+            }
+
+            .login-footer {
+                margin-top: 1.5rem;
+            }
+        }
     </style>
 </head>
+
 <body>
     <div class="login-wrapper">
         <!-- Left Side: Login Form -->
@@ -361,9 +428,14 @@
                     <div class="form-group">
                         <label for="password">Password <span class="required">*</span></label>
                         <div class="password-wrapper">
-                            <input type="password" id="password" name="password" placeholder="Enter password" required autocomplete="current-password">
+                            <input type="password" id="password" name="password" placeholder="Enter password" required
+                                autocomplete="current-password">
                             <button type="button" id="togglePassword" class="password-toggle">
-                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
+                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
+                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
+                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
+                                    <circle cx="12" cy="12" r="3"></circle>
+                                </svg>
                             </button>
                         </div>
                         <div class="error-message" id="password-error">Please enter your password.</div>
@@ -382,18 +454,11 @@
                     <div class="divider">Or, Login with</div>
 
                     <div id="g_id_onload"
-                         data-client_id="807658561801-fj6ujdo8dmha59gkv44mtim6ksailc5i.apps.googleusercontent.com"
-                         data-callback="handleCredentialResponse"
-                         data-auto_prompt="false">
+                        data-client_id="807658561801-fj6ujdo8dmha59gkv44mtim6ksailc5i.apps.googleusercontent.com"
+                        data-callback="handleCredentialResponse" data-auto_prompt="false">
                     </div>
-                    <div class="g_id_signin"
-                         data-type="standard"
-                         data-size="large"
-                         data-theme="outline"
-                         data-text="sign_in_with"
-                         data-shape="rectangular"
-                         data-logo_alignment="left"
-                         data-width="350">
+                    <div class="g_id_signin" data-type="standard" data-size="large" data-theme="outline"
+                        data-text="sign_in_with" data-shape="rectangular" data-logo_alignment="left" data-width="350">
                     </div>
                 </form>
 
@@ -416,23 +481,23 @@
     </div>
 
     <script>
-        document.addEventListener('DOMContentLoaded', function() {
+        document.addEventListener('DOMContentLoaded', function () {
             const loginForm = document.getElementById('loginForm');
             const emailInput = document.getElementById('email');
             const passwordInput = document.getElementById('password');
             const togglePassword = document.getElementById('togglePassword');
-            
+
             const emailError = document.getElementById('email-error');
             const passwordError = document.getElementById('password-error');
 
             // Password visibility toggle
-            togglePassword.addEventListener('click', function() {
+            togglePassword.addEventListener('click', function () {
                 const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                 passwordInput.setAttribute('type', type);
-                
+
                 // Toggle icon
-                this.innerHTML = type === 'password' 
-                    ? '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>' 
+                this.innerHTML = type === 'password'
+                    ? '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>'
                     : '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>';
             });
 
@@ -463,7 +528,7 @@
             emailInput.addEventListener('input', validateEmail);
             passwordInput.addEventListener('input', validatePassword);
 
-            loginForm.addEventListener('submit', async function(event) {
+            loginForm.addEventListener('submit', async function (event) {
                 event.preventDefault(); // Stop form submission to handle it with JS
 
                 const isEmailValid = validateEmail();
@@ -502,13 +567,13 @@
                     submitButton.textContent = 'Log In';
                 }
             });
-            
+
             // Allow form submission with Enter key
-            loginForm.addEventListener('keydown', function(event) {
+            loginForm.addEventListener('keydown', function (event) {
                 if (event.key === 'Enter' && !event.shiftKey) {
                     // Check if the active element is not a button to avoid double submission
-                    if(document.activeElement.type !== 'submit' && document.activeElement.type !== 'button') {
-                       loginForm.requestSubmit();
+                    if (document.activeElement.type !== 'submit' && document.activeElement.type !== 'button') {
+                        loginForm.requestSubmit();
                     }
                 }
             });
@@ -517,7 +582,7 @@
         // Google Sign-In Callback
         function handleCredentialResponse(response) {
             console.log("Encoded JWT ID token: " + response.credential);
-            
+
             // Send the token to the backend
             const formData = new FormData();
             formData.append('action', 'google_login');
@@ -527,19 +592,20 @@
                 method: 'POST',
                 body: formData
             })
-            .then(res => res.json())
-            .then(data => {
-                if (data.success && data.redirect) {
-                    window.location.href = data.redirect;
-                } else {
-                    alert(data.error || 'Google login failed.');
-                }
-            })
-            .catch(err => {
-                console.error('Google login error:', err);
-                alert('Could not connect to the server.');
-            });
+                .then(res => res.json())
+                .then(data => {
+                    if (data.success && data.redirect) {
+                        window.location.href = data.redirect;
+                    } else {
+                        alert(data.error || 'Google login failed.');
+                    }
+                })
+                .catch(err => {
+                    console.error('Google login error:', err);
+                    alert('Could not connect to the server.');
+                });
         }
     </script>
 </body>
-</html>
+
+</html>
\ No newline at end of file
diff --git a/onboarding-wizard.css b/onboarding-wizard.css
index bb1191b..c5bda57 100644
--- a/onboarding-wizard.css
+++ b/onboarding-wizard.css
@@ -2056,3 +2056,52 @@ body {
     from { opacity: 0; transform: scale(0.9); }
     to { opacity: 1; transform: scale(1); }
 }
+
+/* 720p Laptop Optimization (Max Height: 800px) */
+@media (max-height: 800px) {
+  #onboarding-container {
+    min-height: 500px;
+    margin: 1rem auto;
+  }
+  
+  .wizard-progress {
+      padding: 1rem 1.5rem;
+  }
+  
+  .screens-wrapper {
+      padding: 1.5rem 1.5rem;
+      min-height: 350px;
+  }
+  
+  #screen1 h1 {
+      font-size: 2rem;
+      margin-bottom: 0.5rem;
+  }
+  
+  #screen1 .subtitle {
+      font-size: 1rem;
+      margin-bottom: 2rem;
+  }
+  
+  .hero-icons {
+      margin: 2rem 0;
+  }
+  
+  .hero-icon {
+      width: 60px;
+      height: 60px;
+      font-size: 2rem;
+  }
+  
+  .screen h2 {
+      font-size: 1.75rem;
+  }
+  
+  .goal-card {
+      padding: 1.5rem 1rem;
+  }
+  
+  .goal-icon {
+      font-size: 2.5rem;
+  }
+}
diff --git a/quick-start.js b/quick-start.js
index 9b43647..eae86a2 100644
--- a/quick-start.js
+++ b/quick-start.js
@@ -12,36 +12,36 @@ class QuickStartManager {
         this.testAlert = document.getElementById('upcoming-test-alert');
         this.dismissBtn = document.getElementById('quick-start-dismiss');
         this.quickActionCards = document.querySelectorAll('.quick-action-card');
-        
+
         this.sessionData = null;
         this.testData = null;
         this.dismissed = false;
-        
+
         this.init();
     }
-    
+
     init() {
         if (!this.overlay) return;
-        
+
         // Check if overlay should be shown
         const hasActiveChat = document.getElementById('conversation_id')?.value;
         if (hasActiveChat) {
             this.hide();
             return;
         }
-        
+
         // Load recent activity
         this.loadRecentActivity();
-        
+
         // Bind event listeners
         this.bindEvents();
-        
+
         // Animate entrance if visible
         if (!this.overlay.classList.contains('hidden')) {
             this.animateEntrance();
         }
     }
-    
+
     bindEvents() {
         // Quick action cards
         this.quickActionCards.forEach(card => {
@@ -50,14 +50,14 @@ class QuickStartManager {
                 this.handleQuickActionClick(goal);
             });
         });
-        
+
         // Continue learning card
         if (this.continueCard) {
             this.continueCard.addEventListener('click', () => {
                 this.handleContinueLearningClick();
             });
         }
-        
+
         // Test alert prepare button
         const prepareBtn = document.getElementById('test-alert-prepare-btn');
         if (prepareBtn) {
@@ -66,21 +66,21 @@ class QuickStartManager {
                 this.handleTestPrepClick();
             });
         }
-        
+
         // Test alert card (also clickable)
         if (this.testAlert) {
             this.testAlert.addEventListener('click', () => {
                 this.handleTestPrepClick();
             });
         }
-        
+
         // Dismiss button
         if (this.dismissBtn) {
             this.dismissBtn.addEventListener('click', () => {
                 this.dismiss();
             });
         }
-        
+
         // Also dismiss when user starts typing
         const questionInput = document.getElementById('question');
         if (questionInput) {
@@ -91,19 +91,19 @@ class QuickStartManager {
             });
         }
     }
-    
+
     async loadRecentActivity() {
         try {
             const response = await fetch('api/session_context.php?action=recent_activity');
             const data = await response.json();
-            
+
             if (data.success) {
                 // Show continue learning if incomplete session exists
                 if (data.recentSessions && data.recentSessions.length > 0) {
                     this.sessionData = data.recentSessions[0];
                     this.renderContinueLearning(this.sessionData);
                 }
-                
+
                 // Show upcoming test alert
                 if (data.upcomingTests && data.upcomingTests.length > 0) {
                     this.testData = data.upcomingTests[0];
@@ -114,33 +114,48 @@ class QuickStartManager {
             console.error('Failed to load recent activity:', error);
         }
     }
-    
+
     renderContinueLearning(session) {
         if (!this.continueCard || !session) return;
-        
+
         const topicEl = document.getElementById('continue-card-topic');
         if (topicEl) {
             const context = session.context_data || {};
             const topic = context.topic || session.title || 'Previous Session';
-            const progress = session.progress || 0;
-            topicEl.textContent = `${topic} ÔÇó ${progress}% complete`;
+
+            // Show milestones covered instead of percentage
+            const milestonesCompleted = context.milestonesCompleted || 0;
+            const milestonesTotal = context.milestonesTotal || 0;
+
+            if (milestonesTotal > 0) {
+                // Show milestone progress: "Topic ÔÇó 3 of 7 milestones covered"
+                topicEl.textContent = `${topic} ÔÇó ${milestonesCompleted} of ${milestonesTotal} covered`;
+            } else {
+                // Fallback for sessions without milestones yet
+                const msgCount = context.messageCount || session.message_count || 0;
+                if (msgCount > 0) {
+                    topicEl.textContent = `${topic} ÔÇó ${msgCount} ${msgCount === 1 ? 'message' : 'messages'}`;
+                } else {
+                    topicEl.textContent = topic;
+                }
+            }
         }
-        
+
         this.continueCard.classList.remove('hidden');
         this.continueCard.dataset.sessionId = session.id;
-        
+
         // Animate in
         if (typeof gsap !== 'undefined') {
-            gsap.fromTo(this.continueCard, 
+            gsap.fromTo(this.continueCard,
                 { opacity: 0, y: 10 },
                 { opacity: 1, y: 0, duration: 0.4, delay: 0.3 }
             );
         }
     }
-    
+
     renderUpcomingTest(test) {
         if (!this.testAlert || !test) return;
-        
+
         const infoEl = document.getElementById('test-alert-info');
         if (infoEl) {
             const subject = test.subject || 'Test';
@@ -148,40 +163,40 @@ class QuickStartManager {
             const daysText = days === 0 ? 'today' : days === 1 ? 'in 1 day' : `in ${days} days`;
             infoEl.textContent = `${subject} ${daysText}`;
         }
-        
+
         this.testAlert.classList.remove('hidden');
-        
+
         // Animate in
         if (typeof gsap !== 'undefined') {
-            gsap.fromTo(this.testAlert, 
+            gsap.fromTo(this.testAlert,
                 { opacity: 0, y: 10 },
                 { opacity: 1, y: 0, duration: 0.4, delay: 0.4 }
             );
         }
     }
-    
+
     animateEntrance() {
         if (typeof gsap === 'undefined') return;
-        
+
         const content = this.overlay.querySelector('.quick-start-content');
         const orb = this.overlay.querySelector('.quick-start-orb');
         const title = this.overlay.querySelector('.quick-start-title');
         const subtitle = this.overlay.querySelector('.quick-start-subtitle');
         const cards = this.overlay.querySelectorAll('.quick-action-card');
         const dismiss = this.overlay.querySelector('.quick-start-dismiss');
-        
+
         // Timeline for orchestrated animation
         const tl = gsap.timeline();
-        
+
         // Orb fades in and pulses
         if (orb) {
-            tl.fromTo(orb, 
+            tl.fromTo(orb,
                 { opacity: 0, scale: 0.5 },
                 { opacity: 1, scale: 1, duration: 0.6, ease: 'back.out(1.5)' },
                 0
             );
         }
-        
+
         // Title slides up and fades
         if (title) {
             tl.fromTo(title,
@@ -190,7 +205,7 @@ class QuickStartManager {
                 0.2
             );
         }
-        
+
         // Subtitle
         if (subtitle) {
             tl.fromTo(subtitle,
@@ -199,23 +214,23 @@ class QuickStartManager {
                 0.35
             );
         }
-        
+
         // Cards stagger in
         if (cards.length > 0) {
             tl.fromTo(cards,
                 { opacity: 0, y: 20, scale: 0.95 },
-                { 
-                    opacity: 1, 
-                    y: 0, 
-                    scale: 1, 
-                    duration: 0.4, 
+                {
+                    opacity: 1,
+                    y: 0,
+                    scale: 1,
+                    duration: 0.4,
                     stagger: 0.08,
                     ease: 'power2.out'
                 },
                 0.5
             );
         }
-        
+
         // Dismiss button
         if (dismiss) {
             tl.fromTo(dismiss,
@@ -225,12 +240,12 @@ class QuickStartManager {
             );
         }
     }
-    
+
     async handleQuickActionClick(goal) {
         // Create session with goal using SessionContextManager
         try {
             let conversationId = null;
-            
+
             // Use SessionContextManager if available
             if (window.sessionContextManager) {
                 const session = await window.sessionContextManager.create(goal);
@@ -245,32 +260,32 @@ class QuickStartManager {
                         title: this.getGoalTitle(goal)
                     })
                 });
-                
+
                 const data = await response.json();
                 if (data.success && data.conversation_id) {
                     conversationId = data.conversation_id;
                 }
             }
-            
+
             if (conversationId) {
                 // Update hidden input
                 const conversationInput = document.getElementById('conversation_id');
                 if (conversationInput) {
                     conversationInput.value = conversationId;
                 }
-                
+
                 // Store session context globally
                 window.currentSessionGoal = goal;
                 window.currentConversationId = conversationId;
-                
+
                 // Update session context manager with conversation ID
                 if (window.sessionContextManager) {
                     window.sessionContextManager.setConversationId(conversationId);
                 }
-                
+
                 // Dismiss overlay
                 this.dismiss();
-                
+
                 // Trigger AI opening message
                 this.addOpeningMessage(goal);
             }
@@ -279,7 +294,7 @@ class QuickStartManager {
             this.dismiss();
         }
     }
-    
+
     getGoalTitle(goal) {
         const titles = {
             homework_help: 'Homework Help',
@@ -289,20 +304,20 @@ class QuickStartManager {
         };
         return titles[goal] || 'New Chat';
     }
-    
+
     addOpeningMessage(goal) {
         const messages = {
             homework_help: "I'm ready to help with your homework! ­ƒôÜ\n\nWhat subject and topic are you working on? You can also just describe the problem or upload a photo if that's easier.",
-            
+
             test_prep: "Let's prepare you for your test! ­ƒÄ»\n\nTell me:\nÔÇó What subject?\nÔÇó What topics will it cover?\nÔÇó When is it?",
-            
+
             explore: "Let's explore something interesting! ­ƒÆí\n\nWhat topic are you curious about? It can be anything - from your subjects or something completely new.",
-            
+
             practice: "Let's get some practice in! Ô£Å´©Å\n\nWhat subject and topic do you want to practice? I can give you problems at any difficulty level."
         };
-        
+
         const messageText = messages[goal] || "How can I help you today?";
-        
+
         // Use the existing addMessage function if available
         if (typeof addMessage === 'function') {
             addMessage('ai', messageText);
@@ -310,25 +325,25 @@ class QuickStartManager {
             // Fallback: directly add to chat
             this.appendAIMessage(messageText);
         }
-        
+
         // Hide welcome screen and show chat
         const welcomeScreen = document.getElementById('welcome-screen');
         if (welcomeScreen) {
             welcomeScreen.style.display = 'none';
         }
-        
+
         document.body.classList.remove('chat-empty');
     }
-    
+
     appendAIMessage(text) {
         const chatContainer = document.getElementById('chat-container');
         if (!chatContainer) return;
-        
+
         // Convert newlines to <br> and bullets to proper list items
         let html = text
             .replace(/ÔÇó/g, '&bull;')
             .replace(/\n/g, '<br>');
-        
+
         const messageDiv = document.createElement('div');
         messageDiv.className = 'chat-message ai-message';
         messageDiv.innerHTML = `
@@ -336,16 +351,16 @@ class QuickStartManager {
                 <p>${html}</p>
             </div>
         `;
-        
+
         chatContainer.appendChild(messageDiv);
         chatContainer.scrollTop = chatContainer.scrollHeight;
     }
-    
+
     handleContinueLearningClick() {
         if (!this.sessionData) return;
-        
+
         const sessionId = this.sessionData.id;
-        
+
         // Use existing loadConversation function if available
         if (typeof loadConversation === 'function') {
             loadConversation(sessionId);
@@ -353,21 +368,21 @@ class QuickStartManager {
             // Navigate to conversation
             window.location.href = `chat/${sessionId}`;
         }
-        
+
         this.dismiss();
     }
-    
+
     handleTestPrepClick() {
         if (!this.testData) {
             // No test data, just start generic test prep
             this.handleQuickActionClick('test_prep');
             return;
         }
-        
+
         // Create test prep session with pre-filled context
         this.createTestPrepSession(this.testData);
     }
-    
+
     async createTestPrepSession(testData) {
         try {
             const response = await fetch('api/session_context.php?action=create_session', {
@@ -384,34 +399,34 @@ class QuickStartManager {
                     }
                 })
             });
-            
+
             const data = await response.json();
-            
+
             if (data.success && data.conversation_id) {
                 window.currentSessionGoal = 'test_prep';
                 window.currentConversationId = data.conversation_id;
-                
+
                 const conversationInput = document.getElementById('conversation_id');
                 if (conversationInput) {
                     conversationInput.value = data.conversation_id;
                 }
-                
+
                 this.dismiss();
-                
+
                 // Custom opening message for scheduled test
-                const daysText = testData.daysRemaining === 0 ? 'today' : 
-                                 testData.daysRemaining === 1 ? 'tomorrow' : 
-                                 `in ${testData.daysRemaining} days`;
-                
+                const daysText = testData.daysRemaining === 0 ? 'today' :
+                    testData.daysRemaining === 1 ? 'tomorrow' :
+                        `in ${testData.daysRemaining} days`;
+
                 const topic = Array.isArray(testData.topics) ? testData.topics.join(', ') : testData.topics;
                 const message = `Let's prepare for your ${testData.subject} test on ${topic} ${daysText}! ­ƒôØ\n\nHow much time do you have to study right now?`;
-                
+
                 if (typeof addMessage === 'function') {
                     addMessage('ai', message);
                 } else {
                     this.appendAIMessage(message);
                 }
-                
+
                 // Hide welcome screen
                 const welcomeScreen = document.getElementById('welcome-screen');
                 if (welcomeScreen) {
@@ -423,11 +438,11 @@ class QuickStartManager {
             console.error('Failed to create test prep session:', error);
         }
     }
-    
+
     dismiss() {
         if (this.dismissed) return;
         this.dismissed = true;
-        
+
         if (typeof gsap !== 'undefined') {
             gsap.to(this.overlay, {
                 opacity: 0,
@@ -440,28 +455,28 @@ class QuickStartManager {
         } else {
             this.overlay.classList.add('hidden');
         }
-        
+
         // Focus the input
         const questionInput = document.getElementById('question');
         if (questionInput) {
             setTimeout(() => questionInput.focus(), 100);
         }
     }
-    
+
     show(chatAreaOnly = false) {
         this.dismissed = false;
         this.overlay.classList.remove('hidden');
-        
+
         // Toggle between full-screen and chat-area-only modes
         if (chatAreaOnly) {
             this.overlay.classList.add('chat-area-only');
         } else {
             this.overlay.classList.remove('chat-area-only');
         }
-        
+
         this.animateEntrance();
     }
-    
+
     hide() {
         this.overlay.classList.add('hidden');
         this.dismissed = true;
diff --git a/register.html b/register.html
index 7701141..3101667 100644
--- a/register.html
+++ b/register.html
@@ -1,5 +1,6 @@
 <!DOCTYPE html>
 <html lang="en">
+
 <head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
@@ -130,27 +131,66 @@
             box-shadow: 0 0 0 3px rgba(123, 63, 242, 0.2);
         }
 
-        .password-toggle, .valid-icon {
+        .password-toggle,
+        .valid-icon {
             position: absolute;
             top: 50%;
             transform: translateY(-50%);
             color: var(--text-muted);
             cursor: pointer;
         }
-        
-        .password-toggle { right: 1rem; }
-        .valid-icon { right: 1rem; display: none; color: var(--success); }
-        .password-group .valid-icon { right: 3rem; }
 
-        .input-wrapper.valid .valid-icon { display: block; }
-        .input-wrapper.valid input { border-color: var(--success); }
-        .input-wrapper.error input { border-color: var(--error); }
-        .input-wrapper.error.shake { animation: shake 0.5s ease; }
+        .password-toggle {
+            right: 1rem;
+        }
+
+        .valid-icon {
+            right: 1rem;
+            display: none;
+            color: var(--success);
+        }
+
+        .password-group .valid-icon {
+            right: 3rem;
+        }
+
+        .input-wrapper.valid .valid-icon {
+            display: block;
+        }
+
+        .input-wrapper.valid input {
+            border-color: var(--success);
+        }
+
+        .input-wrapper.error input {
+            border-color: var(--error);
+        }
+
+        .input-wrapper.error.shake {
+            animation: shake 0.5s ease;
+        }
 
         @keyframes shake {
-            0%, 100% { transform: translateX(0); }
-            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
-            20%, 40%, 60%, 80% { transform: translateX(5px); }
+
+            0%,
+            100% {
+                transform: translateX(0);
+            }
+
+            10%,
+            30%,
+            50%,
+            70%,
+            90% {
+                transform: translateX(-5px);
+            }
+
+            20%,
+            40%,
+            60%,
+            80% {
+                transform: translateX(5px);
+            }
         }
 
         .error-message {
@@ -175,9 +215,18 @@
             border-radius: 5px;
             transition: width 0.3s ease, background-color 0.3s ease;
         }
-        .password-strength-bar.weak { background-color: var(--error); }
-        .password-strength-bar.medium { background-color: var(--accent); }
-        .password-strength-bar.strong { background-color: var(--success); }
+
+        .password-strength-bar.weak {
+            background-color: var(--error);
+        }
+
+        .password-strength-bar.medium {
+            background-color: var(--accent);
+        }
+
+        .password-strength-bar.strong {
+            background-color: var(--success);
+        }
 
         .strength-text {
             font-size: 0.8rem;
@@ -210,8 +259,16 @@
             text-decoration: none;
             font-weight: 500;
         }
-        .terms-group a:hover { text-decoration: underline; }
-        .terms-group .error-message { position: absolute; bottom: -1.5em; left: 0; }
+
+        .terms-group a:hover {
+            text-decoration: underline;
+        }
+
+        .terms-group .error-message {
+            position: absolute;
+            bottom: -1.5em;
+            left: 0;
+        }
 
         button[type="submit"] {
             width: 100%;
@@ -250,8 +307,13 @@
         }
 
         @keyframes spin {
-            from { transform: rotate(0deg); }
-            to { transform: rotate(360deg); }
+            from {
+                transform: rotate(0deg);
+            }
+
+            to {
+                transform: rotate(360deg);
+            }
         }
 
         .divider {
@@ -270,8 +332,13 @@
             border-bottom: 1px solid var(--border);
         }
 
-        .divider:not(:empty)::before { margin-right: .5em; }
-        .divider:not(:empty)::after { margin-left: .5em; }
+        .divider:not(:empty)::before {
+            margin-right: .5em;
+        }
+
+        .divider:not(:empty)::after {
+            margin-left: .5em;
+        }
 
         .social-signup-btn {
             width: 100%;
@@ -355,47 +422,62 @@
         }
 
         .shape-1 {
-            width: 400px; height: 400px;
+            width: 400px;
+            height: 400px;
             background-color: var(--secondary);
-            top: -100px; left: -150px;
+            top: -100px;
+            left: -150px;
             animation-duration: 20s;
         }
 
         .shape-2 {
-            width: 250px; height: 250px;
+            width: 250px;
+            height: 250px;
             background-color: var(--cyan);
-            bottom: -80px; right: -100px;
+            bottom: -80px;
+            right: -100px;
             animation-duration: 18s;
             animation-delay: -5s;
         }
 
         .shape-3 {
-            width: 150px; height: 150px;
+            width: 150px;
+            height: 150px;
             background-color: var(--yellow);
-            top: 20%; right: 10%;
+            top: 20%;
+            right: 10%;
             border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;
             animation-duration: 25s;
         }
 
         .shape-4 {
-            width: 80px; height: 80px;
+            width: 80px;
+            height: 80px;
             border: 5px solid var(--primary-light);
-            bottom: 30%; left: 15%;
+            bottom: 30%;
+            left: 15%;
             animation-duration: 16s;
         }
 
         .shape-5 {
-            width: 300px; height: 300px;
+            width: 300px;
+            height: 300px;
             background-color: var(--accent);
-            bottom: 10%; left: -150px;
+            bottom: 10%;
+            left: -150px;
             opacity: 0.1;
             animation-duration: 22s;
             animation-delay: -10s;
         }
 
         @keyframes float {
-            0% { transform: translateY(0px) rotate(0deg); }
-            100% { transform: translateY(-40px) rotate(90deg); }
+            0% {
+                transform: translateY(0px) rotate(0deg);
+            }
+
+            100% {
+                transform: translateY(-40px) rotate(90deg);
+            }
         }
 
         /* Responsive Design */
@@ -403,20 +485,75 @@
             .register-container {
                 flex-direction: column;
             }
-            .register-left, .register-right {
+
+            .register-left,
+            .register-right {
                 width: 100%;
             }
+
             .register-right {
                 min-height: 250px;
-                order: -1; /* Move to top */
+                order: -1;
+                /* Move to top */
             }
+
             .register-left {
                 padding: 2rem 1rem;
             }
-            .welcome-text h3 { font-size: 2rem; }
+
+            .welcome-text h3 {
+                font-size: 2rem;
+            }
+        }
+
+        /* 720p Optimization */
+        @media (max-height: 800px) {
+            .register-left {
+                padding: 2rem 1.5rem;
+            }
+
+            .logo-container {
+                margin-bottom: 1.25rem;
+            }
+
+            .logo-container i {
+                font-size: 1.5rem;
+            }
+
+            .logo-container h1 {
+                font-size: 1.5rem;
+            }
+
+            .register-form-container h2 {
+                font-size: 1.75rem;
+                margin-bottom: 0.25rem;
+            }
+
+            .register-form-container .subtitle {
+                margin-bottom: 1.5rem;
+            }
+
+            .input-group {
+                margin-bottom: 1rem;
+            }
+
+            .input-group input[type="text"],
+            .input-group input[type="email"],
+            .input-group input[type="password"] {
+                padding: 0.6rem 0.9rem;
+            }
+
+            .divider {
+                margin: 1.25rem 0;
+            }
+
+            .login-link {
+                margin-top: 1.5rem;
+            }
         }
     </style>
 </head>
+
 <body>
     <div class="register-container">
         <!-- Left Side: Registration Form -->
@@ -442,7 +579,8 @@
                     <div class="input-group">
                         <label for="username">Username <span class="required">*</span></label>
                         <div class="input-wrapper">
-                            <input type="text" id="username" name="username" placeholder="Choose a unique username" required>
+                            <input type="text" id="username" name="username" placeholder="Choose a unique username"
+                                required>
                             <i class="fas fa-check-circle valid-icon"></i>
                         </div>
                         <small class="error-message"></small>
@@ -460,7 +598,8 @@
                     <div class="input-group password-group">
                         <label for="password">Password <span class="required">*</span></label>
                         <div class="input-wrapper">
-                            <input type="password" id="password" name="password" placeholder="Create a password" required>
+                            <input type="password" id="password" name="password" placeholder="Create a password"
+                                required>
                             <i class="fas fa-eye-slash password-toggle"></i>
                         </div>
                         <div class="password-strength">
@@ -473,7 +612,8 @@
                     <div class="input-group password-group">
                         <label for="confirmPassword">Confirm Password <span class="required">*</span></label>
                         <div class="input-wrapper">
-                            <input type="password" id="confirmPassword" name="confirmPassword" placeholder="Confirm your password" required>
+                            <input type="password" id="confirmPassword" name="confirmPassword"
+                                placeholder="Confirm your password" required>
                             <i class="fas fa-eye-slash password-toggle"></i>
                             <i class="fas fa-check-circle valid-icon"></i>
                         </div>
@@ -494,21 +634,13 @@
                 </div>
 
                 <div id="g_id_onload"
-                     data-client_id="807658561801-fj6ujdo8dmha59gkv44mtim6ksailc5i.apps.googleusercontent.com"
-                     data-context="signup"
-                     data-ux_mode="popup"
-                     data-callback="handleCredentialResponse"
-                     data-auto_prompt="false">
+                    data-client_id="807658561801-fj6ujdo8dmha59gkv44mtim6ksailc5i.apps.googleusercontent.com"
+                    data-context="signup" data-ux_mode="popup" data-callback="handleCredentialResponse"
+                    data-auto_prompt="false">
                 </div>
 
-                <div class="g_id_signin"
-                     data-type="standard"
-                     data-shape="rectangular"
-                     data-theme="outline"
-                     data-text="signup_with"
-                     data-size="large"
-                     data-logo_alignment="left"
-                     data-width="350">
+                <div class="g_id_signin" data-type="standard" data-shape="rectangular" data-theme="outline"
+                    data-text="signup_with" data-size="large" data-logo_alignment="left" data-width="350">
                 </div>
 
                 <p class="login-link">
@@ -532,216 +664,217 @@
     </div>
 
     <script>
-    document.addEventListener('DOMContentLoaded', function() {
-        const registerForm = document.getElementById('registerForm');
-        const fullNameInput = document.getElementById('fullName');
-        const usernameInput = document.getElementById('username');
-        const emailInput = document.getElementById('email');
-        const passwordInput = document.getElementById('password');
-        const confirmPasswordInput = document.getElementById('confirmPassword');
-        const termsCheckbox = document.getElementById('terms');
-        const createAccountBtn = document.getElementById('createAccountBtn');
-        const passwordToggles = document.querySelectorAll('.password-toggle');
-
-        const strengthBar = document.querySelector('.password-strength-bar');
-        const strengthText = document.querySelector('.strength-text');
-
-        const validators = {
-            username: {
-                validate: () => /^[a-zA-Z0-9_]{3,15}$/.test(usernameInput.value),
-                message: "Username must be 3-15 characters (letters, numbers, _)"
-            },
-            email: {
-                validate: () => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailInput.value),
-                message: "Please enter a valid email address"
-            },
-            password: {
-                validate: () => passwordInput.value.length >= 8,
-                message: "Password must be at least 8 characters"
-            },
-            confirmPassword: {
-                validate: () => confirmPasswordInput.value === passwordInput.value && confirmPasswordInput.value.length > 0,
-                message: "Passwords do not match"
-            },
-            terms: {
-                validate: () => termsCheckbox.checked,
-                message: "Please agree to the Terms & Conditions"
-            }
-        };
-
-        const checkFieldValidity = (field, validator) => {
-            const inputGroup = field.closest('.input-group, .terms-group');
-            const errorMsg = inputGroup.querySelector('.error-message');
-            const inputWrapper = field.closest('.input-wrapper');
-
-            if (validator.validate()) {
-                inputGroup.classList.remove('error');
-                if (inputWrapper) inputWrapper.classList.add('valid');
-                if (errorMsg) errorMsg.textContent = '';
-                return true;
-            } else {
-                inputGroup.classList.add('error');
-                if (inputWrapper) {
-                    inputWrapper.classList.remove('valid');
-                    inputWrapper.classList.add('shake');
-                    setTimeout(() => inputWrapper.classList.remove('shake'), 500);
+        document.addEventListener('DOMContentLoaded', function () {
+            const registerForm = document.getElementById('registerForm');
+            const fullNameInput = document.getElementById('fullName');
+            const usernameInput = document.getElementById('username');
+            const emailInput = document.getElementById('email');
+            const passwordInput = document.getElementById('password');
+            const confirmPasswordInput = document.getElementById('confirmPassword');
+            const termsCheckbox = document.getElementById('terms');
+            const createAccountBtn = document.getElementById('createAccountBtn');
+            const passwordToggles = document.querySelectorAll('.password-toggle');
+
+            const strengthBar = document.querySelector('.password-strength-bar');
+            const strengthText = document.querySelector('.strength-text');
+
+            const validators = {
+                username: {
+                    validate: () => /^[a-zA-Z0-9_]{3,15}$/.test(usernameInput.value),
+                    message: "Username must be 3-15 characters (letters, numbers, _)"
+                },
+                email: {
+                    validate: () => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailInput.value),
+                    message: "Please enter a valid email address"
+                },
+                password: {
+                    validate: () => passwordInput.value.length >= 8,
+                    message: "Password must be at least 8 characters"
+                },
+                confirmPassword: {
+                    validate: () => confirmPasswordInput.value === passwordInput.value && confirmPasswordInput.value.length > 0,
+                    message: "Passwords do not match"
+                },
+                terms: {
+                    validate: () => termsCheckbox.checked,
+                    message: "Please agree to the Terms & Conditions"
                 }
-                if (errorMsg) errorMsg.textContent = validator.message;
-                return false;
-            }
-        };
-
-        const checkFormValidity = () => {
-            let isFormValid = true;
-            for (const key in validators) {
-                if (!validators[key].validate()) {
-                    isFormValid = false;
-                    break;
+            };
+
+            const checkFieldValidity = (field, validator) => {
+                const inputGroup = field.closest('.input-group, .terms-group');
+                const errorMsg = inputGroup.querySelector('.error-message');
+                const inputWrapper = field.closest('.input-wrapper');
+
+                if (validator.validate()) {
+                    inputGroup.classList.remove('error');
+                    if (inputWrapper) inputWrapper.classList.add('valid');
+                    if (errorMsg) errorMsg.textContent = '';
+                    return true;
+                } else {
+                    inputGroup.classList.add('error');
+                    if (inputWrapper) {
+                        inputWrapper.classList.remove('valid');
+                        inputWrapper.classList.add('shake');
+                        setTimeout(() => inputWrapper.classList.remove('shake'), 500);
+                    }
+                    if (errorMsg) errorMsg.textContent = validator.message;
+                    return false;
                 }
-            }
-            createAccountBtn.disabled = !isFormValid;
-        };
-
-        const checkPasswordStrength = () => {
-            const password = passwordInput.value;
-            let score = 0;
-            if (password.length >= 8) score++;
-            if (/[A-Z]/.test(password)) score++;
-            if (/[a-z]/.test(password)) score++;
-            if (/[0-9]/.test(password)) score++;
-            if (/[^A-Za-z0-9]/.test(password)) score++;
-
-            strengthBar.className = 'password-strength-bar'; // Reset
-            if (password.length === 0) {
-                strengthBar.style.width = '0%';
-                strengthText.textContent = '';
-            } else if (score < 3) {
-                strengthBar.style.width = '33%';
-                strengthBar.classList.add('weak');
-                strengthText.textContent = 'Weak';
-                strengthText.style.color = 'var(--error)';
-            } else if (score < 5) {
-                strengthBar.style.width = '66%';
-                strengthBar.classList.add('medium');
-                strengthText.textContent = 'Medium';
-                strengthText.style.color = 'var(--accent)';
-            } else {
-                strengthBar.style.width = '100%';
-                strengthBar.classList.add('strong');
-                strengthText.textContent = 'Strong';
-                strengthText.style.color = 'var(--success)';
-            }
-        };
-
-        // Event Listeners
-        usernameInput.addEventListener('input', () => {
-            checkFieldValidity(usernameInput, validators.username);
-            checkFormValidity();
-        });
-        emailInput.addEventListener('input', () => {
-            checkFieldValidity(emailInput, validators.email);
-            checkFormValidity();
-        });
-        passwordInput.addEventListener('input', () => {
-            checkFieldValidity(passwordInput, validators.password);
-            checkPasswordStrength();
-            // Re-validate confirm password if it has a value
-            if (confirmPasswordInput.value) {
-                checkFieldValidity(confirmPasswordInput, validators.confirmPassword);
-            }
-            checkFormValidity();
-        });
-        confirmPasswordInput.addEventListener('input', () => {
-            checkFieldValidity(confirmPasswordInput, validators.confirmPassword);
-            checkFormValidity();
-        });
-        termsCheckbox.addEventListener('change', () => {
-            checkFieldValidity(termsCheckbox, validators.terms);
-            checkFormValidity();
-        });
+            };
+
+            const checkFormValidity = () => {
+                let isFormValid = true;
+                for (const key in validators) {
+                    if (!validators[key].validate()) {
+                        isFormValid = false;
+                        break;
+                    }
+                }
+                createAccountBtn.disabled = !isFormValid;
+            };
+
+            const checkPasswordStrength = () => {
+                const password = passwordInput.value;
+                let score = 0;
+                if (password.length >= 8) score++;
+                if (/[A-Z]/.test(password)) score++;
+                if (/[a-z]/.test(password)) score++;
+                if (/[0-9]/.test(password)) score++;
+                if (/[^A-Za-z0-9]/.test(password)) score++;
+
+                strengthBar.className = 'password-strength-bar'; // Reset
+                if (password.length === 0) {
+                    strengthBar.style.width = '0%';
+                    strengthText.textContent = '';
+                } else if (score < 3) {
+                    strengthBar.style.width = '33%';
+                    strengthBar.classList.add('weak');
+                    strengthText.textContent = 'Weak';
+                    strengthText.style.color = 'var(--error)';
+                } else if (score < 5) {
+                    strengthBar.style.width = '66%';
+                    strengthBar.classList.add('medium');
+                    strengthText.textContent = 'Medium';
+                    strengthText.style.color = 'var(--accent)';
+                } else {
+                    strengthBar.style.width = '100%';
+                    strengthBar.classList.add('strong');
+                    strengthText.textContent = 'Strong';
+                    strengthText.style.color = 'var(--success)';
+                }
+            };
 
-        passwordToggles.forEach(toggle => {
-            toggle.addEventListener('click', () => {
-                const passwordField = toggle.previousElementSibling;
-                const type = passwordField.getAttribute('type') === 'password' ? 'text' : 'password';
-                passwordField.setAttribute('type', type);
-                toggle.classList.toggle('fa-eye');
-                toggle.classList.toggle('fa-eye-slash');
+            // Event Listeners
+            usernameInput.addEventListener('input', () => {
+                checkFieldValidity(usernameInput, validators.username);
+                checkFormValidity();
             });
-        });
-
-        registerForm.addEventListener('submit', async (e) => {
-            e.preventDefault();
-
-            let isFormValid = true;
-            Object.keys(validators).forEach(key => {
-                const field = document.getElementById(key);
-                if (!checkFieldValidity(field, validators[key])) {
-                    isFormValid = false;
+            emailInput.addEventListener('input', () => {
+                checkFieldValidity(emailInput, validators.email);
+                checkFormValidity();
+            });
+            passwordInput.addEventListener('input', () => {
+                checkFieldValidity(passwordInput, validators.password);
+                checkPasswordStrength();
+                // Re-validate confirm password if it has a value
+                if (confirmPasswordInput.value) {
+                    checkFieldValidity(confirmPasswordInput, validators.confirmPassword);
                 }
+                checkFormValidity();
+            });
+            confirmPasswordInput.addEventListener('input', () => {
+                checkFieldValidity(confirmPasswordInput, validators.confirmPassword);
+                checkFormValidity();
+            });
+            termsCheckbox.addEventListener('change', () => {
+                checkFieldValidity(termsCheckbox, validators.terms);
+                checkFormValidity();
             });
 
-            if (!isFormValid) {
-                return;
-            }
-
-            createAccountBtn.disabled = true;
-            createAccountBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating...';
+            passwordToggles.forEach(toggle => {
+                toggle.addEventListener('click', () => {
+                    const passwordField = toggle.previousElementSibling;
+                    const type = passwordField.getAttribute('type') === 'password' ? 'text' : 'password';
+                    passwordField.setAttribute('type', type);
+                    toggle.classList.toggle('fa-eye');
+                    toggle.classList.toggle('fa-eye-slash');
+                });
+            });
 
-            const formData = new FormData(registerForm);
-            formData.append('action', 'register');
+            registerForm.addEventListener('submit', async (e) => {
+                e.preventDefault();
 
-            try {
-                const response = await fetch(registerForm.action, {
-                    method: 'POST',
-                    body: formData
+                let isFormValid = true;
+                Object.keys(validators).forEach(key => {
+                    const field = document.getElementById(key);
+                    if (!checkFieldValidity(field, validators[key])) {
+                        isFormValid = false;
+                    }
                 });
 
-                const result = await response.json();
+                if (!isFormValid) {
+                    return;
+                }
 
-                if (result.success && result.redirect) {
-                    // Redirect to the chat page on successful registration and login
-                    window.location.href = result.redirect;
-                } else {
-                    alert('Error: ' + result.error);
+                createAccountBtn.disabled = true;
+                createAccountBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating...';
+
+                const formData = new FormData(registerForm);
+                formData.append('action', 'register');
+
+                try {
+                    const response = await fetch(registerForm.action, {
+                        method: 'POST',
+                        body: formData
+                    });
+
+                    const result = await response.json();
+
+                    if (result.success && result.redirect) {
+                        // Redirect to the chat page on successful registration and login
+                        window.location.href = result.redirect;
+                    } else {
+                        alert('Error: ' + result.error);
+                    }
+                } catch (error) {
+                    console.error('Submission error:', error);
+                    alert('An unexpected error occurred. Please try again.');
+                } finally {
+                    createAccountBtn.disabled = false;
+                    createAccountBtn.innerHTML = 'Create Account';
                 }
-            } catch (error) {
-                console.error('Submission error:', error);
-                alert('An unexpected error occurred. Please try again.');
-            } finally {
-                createAccountBtn.disabled = false;
-                createAccountBtn.innerHTML = 'Create Account';
-            }
-        });
-    });
-
-    // Google Sign-In Callback
-    function handleCredentialResponse(response) {
-        console.log("Encoded JWT ID token: " + response.credential);
-        
-        // Send the token to the backend
-        const formData = new FormData();
-        formData.append('action', 'google_login');
-        formData.append('credential', response.credential);
-
-        fetch('auth_mysql.php', {
-            method: 'POST',
-            body: formData
-        })
-        .then(res => res.json())
-        .then(data => {
-            if (data.success && data.redirect) {
-                window.location.href = data.redirect;
-            } else {
-                alert(data.error || 'Google signup failed.');
-            }
-        })
-        .catch(err => {
-            console.error('Google signup error:', err);
-            alert('Could not connect to the server.');
+            });
         });
-    }
-    
+
+        // Google Sign-In Callback
+        function handleCredentialResponse(response) {
+            console.log("Encoded JWT ID token: " + response.credential);
+
+            // Send the token to the backend
+            const formData = new FormData();
+            formData.append('action', 'google_login');
+            formData.append('credential', response.credential);
+
+            fetch('auth_mysql.php', {
+                method: 'POST',
+                body: formData
+            })
+                .then(res => res.json())
+                .then(data => {
+                    if (data.success && data.redirect) {
+                        window.location.href = data.redirect;
+                    } else {
+                        alert(data.error || 'Google signup failed.');
+                    }
+                })
+                .catch(err => {
+                    console.error('Google signup error:', err);
+                    alert('Could not connect to the server.');
+                });
+        }
+
     </script>
 </body>
+
 </html>
\ No newline at end of file
diff --git a/server_mysql.php b/server_mysql.php
index 781118e..f1569c0 100644
--- a/server_mysql.php
+++ b/server_mysql.php
@@ -18,7 +18,8 @@ require 'vendor/autoload.php';
 header('Content-Type: application/json');
 
 if (!function_exists('formatResponse')) {
-    function formatResponse($text) {
+    function formatResponse($text)
+    {
         $protections = [];
         $counter = 0;
 
@@ -87,7 +88,7 @@ if (!function_exists('formatResponse')) {
                 $html = str_replace($placeholder, '<code>' . $codeContent . '</code>', $html);
             }
         }
-        
+
         // Final cleanup: remove <p> tags from around display math
         $html = preg_replace('/<p>(\s*)(\$\$.*?\$\$)(\s*)<\/p>/s', '$2', $html);
         $html = preg_replace('/<p>(\s*)(\\\\\[.*?\\\\\])(\s*)<\/p>/s', '$2', $html);
@@ -150,7 +151,7 @@ if ($action) {
                 foreach ($messages as $message) {
                     // The 'content' is a JSON string of the 'parts' array, so we decode it.
                     $parts = json_decode($message['content'], true);
-                    
+
                     // PERFORMANCE OPTIMIZATION: Strip out heavy base64 image data for history loading
                     foreach ($parts as &$part) {
                         if (isset($part['inline_data']['data'])) {
@@ -160,7 +161,7 @@ if ($action) {
                             $part['inline_data']['_removed'] = true; // Flag for frontend
                         }
                     }
-                    
+
                     if ($message['role'] === 'model') {
                         $parts[0]['text'] = formatResponse($parts[0]['text']);
                     }
@@ -183,7 +184,7 @@ if ($action) {
             $stmt->execute([$convo_id, $_SESSION['user_id']]);
             echo json_encode(['success' => true]);
             break;
-        
+
         case 'rename_conversation':
             if ($_SERVER['REQUEST_METHOD'] !== 'POST') {
                 http_response_code(405);
@@ -208,13 +209,13 @@ if ($action) {
         case 'generate_suggestions':
             try {
                 $pdo = getDbConnection();
-                
+
                 // Fetch user's field of study
                 $stmt = $pdo->prepare("SELECT field_of_study FROM users WHERE id = ?");
                 $stmt->execute([$_SESSION['user_id']]);
                 $user = $stmt->fetch(PDO::FETCH_ASSOC);
                 $field = $user['field_of_study'] ?? 'General Knowledge';
-                
+
                 // Construct prompt for Gemini
                 $prompt = "Generate 4 short, engaging, single-sentence learning tasks for a student studying '{$field}'. 
                 Return ONLY a valid JSON object with keys: 'explain', 'write', 'build', 'research'.
@@ -233,21 +234,22 @@ if ($action) {
                 // Since functions are global in PHP, we can call callGeminiAPI if it's defined.
                 // However, callGeminiAPI is defined at the bottom. We should move it up or just use the logic here.
                 // For safety, let's just implement the call here directly to avoid scope issues if the function isn't hoisted yet (though PHP functions are).
-                
+
                 // Load API Key
                 $config = null;
                 $configFiles = ['config-sql.ini', 'config.ini'];
                 foreach ($configFiles as $configFile) {
                     if (file_exists($configFile)) {
                         $config = parse_ini_file($configFile);
-                        if ($config !== false) break;
+                        if ($config !== false)
+                            break;
                     }
                 }
                 if ($config === false || !isset($config['GEMINI_API_KEY'])) {
                     throw new Exception('API key missing.');
                 }
                 $apiKey = $config['GEMINI_API_KEY'];
-                
+
                 $payload = json_encode([
                     "contents" => [
                         ["parts" => [["text" => $prompt]]]
@@ -265,30 +267,33 @@ if ($action) {
                     CURLOPT_HTTPHEADER => ['Content-Type: application/json'],
                     CURLOPT_TIMEOUT => 10
                 ]);
-                
+
                 $response = curl_exec($ch);
                 $http_status = curl_getinfo($ch, CURLINFO_HTTP_CODE);
                 curl_close($ch);
-                
+
                 if ($http_status !== 200) {
                     throw new Exception("Gemini API error: $http_status");
                 }
-                
+
                 $data = json_decode($response, true);
                 $jsonText = $data['candidates'][0]['content']['parts'][0]['text'] ?? '{}';
                 $suggestions = json_decode($jsonText, true);
-                
+
                 echo json_encode(['success' => true, 'suggestions' => $suggestions]);
-                
+
             } catch (Exception $e) {
                 error_log("Suggestion generation error: " . $e->getMessage());
                 // Fallback suggestions
-                echo json_encode(['success' => false, 'suggestions' => [
-                    'explain' => 'Explain a complex topic simply.',
-                    'write' => 'Write a creative story.',
-                    'build' => 'Build a study plan.',
-                    'research' => 'Research a new technology.'
-                ]]);
+                echo json_encode([
+                    'success' => false,
+                    'suggestions' => [
+                        'explain' => 'Explain a complex topic simply.',
+                        'write' => 'Write a creative story.',
+                        'build' => 'Build a study plan.',
+                        'research' => 'Research a new technology.'
+                    ]
+                ]);
             }
             break;
 
@@ -326,13 +331,14 @@ if (!empty($_POST['session_context'])) {
 
 $conversation_id = $_POST['conversation_id'] ?? null;
 
-function prepareFileParts($file, $user_question) {
+function prepareFileParts($file, $user_question)
+{
     $filePath = $file['tmp_name'];
     // Check if file exists to avoid warnings
     if (!file_exists($filePath)) {
         throw new Exception("File upload failed: Temporary file not found.");
     }
-    
+
     $fileType = mime_content_type($filePath);
     $originalName = $file['name'];
     $extension = strtolower(pathinfo($originalName, PATHINFO_EXTENSION));
@@ -342,11 +348,11 @@ function prepareFileParts($file, $user_question) {
         'pdf' => 'application/pdf',
         'docx' => 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
         'pptx' => 'application/vnd.openxmlformats-officedocument.presentationml.presentation',
-        'jpg'  => 'image/jpeg',
+        'jpg' => 'image/jpeg',
         'jpeg' => 'image/jpeg',
-        'png'  => 'image/png',
-        'gif'  => 'image/gif',
-        'bmp'  => 'image/bmp',
+        'png' => 'image/png',
+        'gif' => 'image/gif',
+        'bmp' => 'image/bmp',
         'webp' => 'image/webp',
     ];
 
@@ -357,7 +363,7 @@ function prepareFileParts($file, $user_question) {
 
     // Double-check MIME type
     if (!in_array($fileType, $allowed_types)) {
-         // Allow for some variation in MIME types reported by servers
+        // Allow for some variation in MIME types reported by servers
         if ($extension !== 'docx' || $fileType !== 'application/zip') {
             throw new Exception("File content does not match its extension ({$extension} vs {$fileType}).");
         }
@@ -368,7 +374,7 @@ function prepareFileParts($file, $user_question) {
         if (!extension_loaded('gd')) {
             throw new Exception("The 'gd' PHP extension is required to process images but it is not enabled. Please enable it in your php.ini file.");
         }
-        
+
         // Load and potentially resize the image to prevent "server has gone away" errors
         $srcImage = null;
         switch ($fileType) {
@@ -388,53 +394,53 @@ function prepareFileParts($file, $user_question) {
                 $srcImage = imagecreatefromwebp($filePath);
                 break;
         }
-        
+
         if (!$srcImage) {
             throw new Exception("Could not process the image file '{$originalName}'.");
         }
-        
+
         // Get original dimensions
         $origWidth = imagesx($srcImage);
         $origHeight = imagesy($srcImage);
-        
+
         // Resize to smaller dimensions to prevent DB packet errors
         // Most MySQL servers have max_allowed_packet around 4-16MB
         // After base64 encoding, size increases by ~33%, so we need to be conservative
         $maxWidth = 1024;  // Reduced from 1920 for better compression
         $maxHeight = 1024;
-        
+
         // Always resize and compress to JPEG for consistency and smaller size
         // Calculate new dimensions maintaining aspect ratio
         $ratio = min($maxWidth / $origWidth, $maxHeight / $origHeight);
-        $newWidth = (int)($origWidth * $ratio);
-        $newHeight = (int)($origHeight * $ratio);
-        
+        $newWidth = (int) ($origWidth * $ratio);
+        $newHeight = (int) ($origHeight * $ratio);
+
         // Create resized image
         $dstImage = imagecreatetruecolor($newWidth, $newHeight);
-        
+
         // Preserve transparency for PNG/GIF by using white background
         if ($fileType === 'image/png' || $fileType === 'image/gif') {
             $white = imagecolorallocate($dstImage, 255, 255, 255);
             imagefilledrectangle($dstImage, 0, 0, $newWidth, $newHeight, $white);
         }
-        
+
         imagecopyresampled($dstImage, $srcImage, 0, 0, 0, 0, $newWidth, $newHeight, $origWidth, $origHeight);
-        
+
         // Convert to JPEG with more aggressive compression
         ob_start();
         imagejpeg($dstImage, null, 75); // 75% quality - more aggressive compression
         $fileData = ob_get_clean();
         $fileType = 'image/jpeg';
-        
+
         imagedestroy($srcImage);
         imagedestroy($dstImage);
-        
+
         // Final safety check: if the image is still too large, reject it
         $maxSizeBytes = 3 * 1024 * 1024; // 3MB raw limit (becomes ~4MB after base64)
         if (strlen($fileData) > $maxSizeBytes) {
             throw new Exception("Image file is too large even after compression. Please use a smaller image.");
         }
-        
+
         $base64Data = base64_encode($fileData);
 
         return [
@@ -467,8 +473,8 @@ function prepareFileParts($file, $user_question) {
             foreach ($phpWord->getSections() as $section) {
                 foreach ($section->getElements() as $element) {
                     if ($element instanceof \PhpOffice\PhpWord\Element\TextRun) {
-                        foreach($element->getElements() as $textElement) {
-                             if ($textElement instanceof \PhpOffice\PhpWord\Element\Text) {
+                        foreach ($element->getElements() as $textElement) {
+                            if ($textElement instanceof \PhpOffice\PhpWord\Element\Text) {
                                 $text .= $textElement->getText() . ' ';
                             }
                         }
@@ -576,11 +582,12 @@ function callGeminiAPI($payload, $apiKey) {
         $curl_error = curl_error($ch);
         curl_close($ch);
 
-        if ($curl_error) throw new Exception('cURL Error: ' . $curl_error);
-        
+        if ($curl_error)
+            throw new Exception('cURL Error: ' . $curl_error);
+
         if ($http_status === 429 || $http_status === 503) {
             $retries++;
-            
+
             // If we hit a rate limit with the experimental model, try falling back to stable 2.5-flash
             if ($model === 'gemini-2.0-flash-exp' && $retries > 1) {
                 $model = 'gemini-3-flash-preview';
@@ -589,42 +596,43 @@ function callGeminiAPI($payload, $apiKey) {
                 continue;
             }
 
-            if ($retries >= $max_retries) throw new Exception('AI service rate limit exceeded. Please try again in a moment.');
+            if ($retries >= $max_retries)
+                throw new Exception('AI service rate limit exceeded. Please try again in a moment.');
             sleep($delay);
             $delay *= 2;
             continue;
         }
 
         if ($http_status !== 200) {
-             throw new Exception('AI service returned an error: HTTP ' . $http_status . ' - ' . substr($response, 0, 200));
+            throw new Exception('AI service returned an error: HTTP ' . $http_status . ' - ' . substr($response, 0, 200));
         }
 
         $responseData = json_decode($response, true);
-        
+
         // Check if AI wants to generate an image (function call)
         if (isset($responseData['candidates'][0]['content']['parts'][0]['functionCall'])) {
             $functionCall = $responseData['candidates'][0]['content']['parts'][0]['functionCall'];
             $functionName = $functionCall['name'];
-            
+
             if ($functionName === 'generate_image') {
                 $functionArgs = $functionCall['args'];
                 $imagePrompt = $functionArgs['prompt'];
                 $aspectRatio = $functionArgs['aspectRatio'] ?? '1:1';
-                
+
                 error_log("Chat Service: AI requested image generation - " . substr($imagePrompt, 0, 100));
-                
+
                 try {
                     // Call the image microservice
-                    $imageServiceUrl = (isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] === 'on' ? "https" : "http") 
+                    $imageServiceUrl = (isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] === 'on' ? "https" : "http")
                         . "://{$_SERVER['HTTP_HOST']}/api/image.php";
-                    
+
                     $imagePayload = json_encode([
                         'prompt' => $imagePrompt,
                         'options' => [
                             'aspectRatio' => $aspectRatio
                         ]
                     ]);
-                    
+
                     $ch = curl_init($imageServiceUrl);
                     curl_setopt_array($ch, [
                         CURLOPT_RETURNTRANSFER => true,
@@ -636,18 +644,18 @@ function callGeminiAPI($payload, $apiKey) {
                         ],
                         CURLOPT_TIMEOUT => 90
                     ]);
-                    
+
                     $imageResponse = curl_exec($ch);
                     $imageHttpStatus = curl_getinfo($ch, CURLINFO_HTTP_CODE);
                     curl_close($ch);
-                    
+
                     $imageResult = json_decode($imageResponse, true);
-                    
+
                     if ($imageHttpStatus === 200 && isset($imageResult['success']) && $imageResult['success']) {
                         // Image generated successfully
                         $imageData = $imageResult['imageData'];
                         error_log("Chat Service: Image generation succeeded");
-                        
+
                         return [
                             'candidates' => [
                                 [
@@ -665,7 +673,7 @@ function callGeminiAPI($payload, $apiKey) {
                         // Image service returned an error
                         $errorMsg = $imageResult['error'] ?? 'Unknown error from image service';
                         error_log("Chat Service: Image generation failed - " . $errorMsg);
-                        
+
                         return [
                             'candidates' => [
                                 [
@@ -680,10 +688,10 @@ function callGeminiAPI($payload, $apiKey) {
                             ]
                         ];
                     }
-                    
+
                 } catch (Exception $e) {
                     error_log("Chat Service: Exception calling image service - " . $e->getMessage());
-                    
+
                     return [
                         'candidates' => [
                             [
@@ -700,16 +708,17 @@ function callGeminiAPI($payload, $apiKey) {
                 }
             }
         }
-        
+
         // No function call or normal response
         return $responseData;
     }
 }
 
-function generateImageWithImagen($prompt, $apiKey) {
+function generateImageWithImagen($prompt, $apiKey)
+{
     // Use Imagen 4 Ultra endpoint (stable version)
     $apiUrl = "https://generativelanguage.googleapis.com/v1beta/models/imagen-4.0-ultra-generate-001:predict?key=" . $apiKey;
-    
+
     $payload = json_encode([
         'instances' => [
             ['prompt' => $prompt]
@@ -736,25 +745,282 @@ function generateImageWithImagen($prompt, $apiKey) {
     if ($http_status !== 200) {
         $errorBody = json_decode($response, true);
         $errorMessage = $errorBody['error']['message'] ?? substr($response, 0, 200);
-        
+
         if ($http_status === 400 && strpos($errorMessage, 'billed users') !== false) {
-             throw new Exception("Image generation requires a billed Google Cloud account. Please enable billing for your project.");
+            throw new Exception("Image generation requires a billed Google Cloud account. Please enable billing for your project.");
         }
-        
+
         throw new Exception("Imagen API Error (HTTP $http_status): " . $errorMessage);
     }
 
     $data = json_decode($response, true);
-    
+
     if (isset($data['predictions'][0]['bytesBase64Encoded'])) {
         $base64 = $data['predictions'][0]['bytesBase64Encoded'];
         $mimeType = $data['predictions'][0]['mimeType'] ?? 'image/png';
         return "data:{$mimeType};base64,{$base64}";
     }
-    
+
     throw new Exception("No image data found in response.");
 }
 
+/**
+ * Generate a structured learning outline for a topic using AI.
+ * 
+ * @param string $topic The topic to create an outline for
+ * @param string $sessionGoal The session goal (explore, test_prep, homework_help, practice)
+ * @param string $educationLevel The student's education level
+ * @param string $apiKey The Gemini API key
+ * @return array|null The learning outline with milestones, or null on failure
+ */
+function generateLearningOutline($topic, $sessionGoal, $educationLevel, $apiKey)
+{
+    // Adjust complexity based on session goal
+    $goalInstructions = [
+        'explore' => 'Create a comprehensive exploration outline. Include foundational concepts, key theories, practical applications, and interesting connections to other fields.',
+        'test_prep' => 'Create a focused study outline. Prioritize commonly tested concepts, formulas, and problem types. Include practice checkpoints.',
+        'homework_help' => 'Create a problem-solving outline. Focus on understanding the problem, required concepts, solution steps, and verification.',
+        'practice' => 'Create a skill-building outline. Start with simple examples and progressively increase difficulty. Include plenty of practice opportunities.'
+    ];
+
+    $goalInstruction = $goalInstructions[$sessionGoal] ?? $goalInstructions['explore'];
+
+    $prompt = <<<EOT
+You are a curriculum designer creating a learning outline for teaching "{$topic}" to a {$educationLevel} student.
+
+{$goalInstruction}
+
+Requirements:
+1. Break down the topic into logical milestones (minimum 4, no maximum - use as many as needed for the topic's complexity)
+2. Order milestones from foundational to advanced
+3. Each milestone should be achievable in 2-5 minutes of discussion
+4. Include practical application or synthesis as the final milestone
+5. Make milestone titles clear and specific
+
+Return ONLY a valid JSON object in this exact format:
+{
+    "topic": "{$topic}",
+    "totalMilestones": <number>,
+    "milestones": [
+        {"id": 1, "title": "...", "description": "Brief description of what will be covered", "keyPoints": ["point1", "point2"]},
+        ...
+    ]
+}
+EOT;
+
+    try {
+        $payload = json_encode([
+            "contents" => [
+                ["parts" => [["text" => $prompt]]]
+            ],
+            "generationConfig" => [
+                "responseMimeType" => "application/json",
+                "temperature" => 0.3 // Lower temperature for more consistent structure
+            ]
+        ]);
+
+        $apiUrl = "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=" . $apiKey;
+
+        $ch = curl_init($apiUrl);
+        curl_setopt_array($ch, [
+            CURLOPT_RETURNTRANSFER => true,
+            CURLOPT_POST => true,
+            CURLOPT_POSTFIELDS => $payload,
+            CURLOPT_HTTPHEADER => ['Content-Type: application/json'],
+            CURLOPT_TIMEOUT => 15
+        ]);
+
+        $response = curl_exec($ch);
+        $http_status = curl_getinfo($ch, CURLINFO_HTTP_CODE);
+        curl_close($ch);
+
+        if ($http_status !== 200) {
+            error_log("Outline generation failed: HTTP $http_status");
+            return null;
+        }
+
+        $data = json_decode($response, true);
+        $jsonText = $data['candidates'][0]['content']['parts'][0]['text'] ?? null;
+
+        if (!$jsonText) {
+            error_log("Outline generation: No text in response");
+            return null;
+        }
+
+        $outline = json_decode($jsonText, true);
+
+        if (!$outline || !isset($outline['milestones'])) {
+            error_log("Outline generation: Invalid JSON structure");
+            return null;
+        }
+
+        // Initialize completion status for each milestone
+        foreach ($outline['milestones'] as &$milestone) {
+            $milestone['completed'] = false;
+            $milestone['coveredAt'] = null;
+        }
+
+        $outline['generatedAt'] = date('c');
+        $outline['lastUpdated'] = date('c');
+
+        return $outline;
+
+    } catch (Exception $e) {
+        error_log("Outline generation error: " . $e->getMessage());
+        return null;
+    }
+}
+
+/**
+ * Analyze AI response to detect which milestones were covered.
+ * 
+ * @param string $aiResponse The AI's response text
+ * @param array $milestones The current milestones array
+ * @return array Updated milestones with completion status
+ */
+function detectMilestoneCompletion($aiResponse, $milestones)
+{
+    if (empty($milestones)) {
+        return $milestones;
+    }
+
+    $lowerResponse = strtolower($aiResponse);
+
+    foreach ($milestones as &$milestone) {
+        if ($milestone['completed']) {
+            continue; // Already completed
+        }
+
+        // Check if milestone title or key points are substantially covered
+        $titleWords = preg_split('/\s+/', strtolower($milestone['title']));
+        $matchCount = 0;
+
+        foreach ($titleWords as $word) {
+            if (strlen($word) > 3 && strpos($lowerResponse, $word) !== false) {
+                $matchCount++;
+            }
+        }
+
+        // If more than 50% of significant words from title appear, consider it covered
+        $significantWords = count(array_filter($titleWords, fn($w) => strlen($w) > 3));
+        if ($significantWords > 0 && ($matchCount / $significantWords) >= 0.5) {
+            $milestone['completed'] = true;
+            $milestone['coveredAt'] = date('c');
+        }
+
+        // Also check key points if available
+        if (!$milestone['completed'] && isset($milestone['keyPoints'])) {
+            $keyPointsMatched = 0;
+            foreach ($milestone['keyPoints'] as $point) {
+                $pointWords = preg_split('/\s+/', strtolower($point));
+                foreach ($pointWords as $word) {
+                    if (strlen($word) > 3 && strpos($lowerResponse, $word) !== false) {
+                        $keyPointsMatched++;
+                        break;
+                    }
+                }
+            }
+
+            // If most key points are touched, mark as completed
+            if (
+                count($milestone['keyPoints']) > 0 &&
+                ($keyPointsMatched / count($milestone['keyPoints'])) >= 0.6
+            ) {
+                $milestone['completed'] = true;
+                $milestone['coveredAt'] = date('c');
+            }
+        }
+    }
+
+    return $milestones;
+}
+
+/**
+ * Analyze user message for comprehension signals.
+ * 
+ * @param string $userMessage The user's message
+ * @return float Comprehension delta (-0.15 to +0.15)
+ */
+function analyzeComprehension($userMessage)
+{
+    $lowerMessage = strtolower($userMessage);
+
+    // Positive signals
+    $positivePatterns = [
+        '/\bi (get|got|understand|see)\b/' => 0.10,
+        '/\bmakes sense\b/' => 0.12,
+        '/\bah+\b.*\bok\b/' => 0.08,
+        '/\bthat\'s? (clear|helpful)\b/' => 0.10,
+        '/\bthank(s| you)\b/' => 0.05,
+        '/\bnow i (know|understand)\b/' => 0.15,
+        '/\bperfect\b/' => 0.08,
+        '/\bi can (see|follow)\b/' => 0.10
+    ];
+
+    // Negative signals
+    $negativePatterns = [
+        '/\bi (don\'t|do not) (get|understand)\b/' => -0.12,
+        '/\bconfus(ed|ing)\b/' => -0.10,
+        '/\bwhat (do you mean|does that mean)\b/' => -0.05,
+        '/\bcan you explain (again|more)\b/' => -0.08,
+        '/\bi\'m (lost|stuck)\b/' => -0.10,
+        '/\bstill (don\'t|unclear)\b/' => -0.12,
+        '/\bhuh\??\b/' => -0.05,
+        '/\bwait,? what\b/' => -0.08
+    ];
+
+    $delta = 0.0;
+
+    foreach ($positivePatterns as $pattern => $score) {
+        if (preg_match($pattern, $lowerMessage)) {
+            $delta += $score;
+        }
+    }
+
+    foreach ($negativePatterns as $pattern => $score) {
+        if (preg_match($pattern, $lowerMessage)) {
+            $delta += $score; // score is already negative
+        }
+    }
+
+    // Clamp to reasonable range
+    return max(-0.15, min(0.15, $delta));
+}
+
+/**
+ * Calculate overall progress from milestones and comprehension.
+ * 
+ * @param array $contextData The session context data
+ * @return int Progress percentage (0-100)
+ */
+function calculateHybridProgress($contextData)
+{
+    $milestones = $contextData['outline']['milestones'] ?? [];
+    $comprehensionScore = $contextData['comprehensionScore'] ?? 0.5;
+    $messageCount = $contextData['messageCount'] ?? 0;
+
+    // If no milestones, use message-based progress
+    if (empty($milestones)) {
+        return min(100, intval(($messageCount / 10) * 100));
+    }
+
+    // Calculate milestone completion
+    $completedCount = count(array_filter($milestones, fn($m) => $m['completed'] ?? false));
+    $totalCount = count($milestones);
+    $milestoneProgress = ($completedCount / $totalCount) * 100;
+
+    // Calculate engagement score (capped at 1.0)
+    $engagementScore = min(1.0, $messageCount / 10);
+
+    // Weighted combination: 70% milestones, 20% comprehension, 10% engagement
+    $hybridProgress =
+        ($milestoneProgress * 0.70) +
+        ($comprehensionScore * 100 * 0.20) +
+        ($engagementScore * 100 * 0.10);
+
+    return min(100, max(0, intval($hybridProgress)));
+}
+
 try {
     // Initialize variables that might be used in conditional paths to avoid warnings
     $a = null;
@@ -766,7 +1032,7 @@ try {
     // Try to load config-sql.ini first, then fall back to config.ini
     $config = null;
     $configFiles = ['config-sql.ini', 'config.ini'];
-    
+
     foreach ($configFiles as $configFile) {
         if (file_exists($configFile)) {
             $config = parse_ini_file($configFile);
@@ -775,7 +1041,7 @@ try {
             }
         }
     }
-    
+
     if ($config === false || !isset($config['GEMINI_API_KEY'])) {
         throw new Exception('API key configuration is missing or unreadable in config-sql.ini or config.ini.');
     }
@@ -835,7 +1101,7 @@ try {
     if (!empty($question)) {
         $user_message_parts[] = ['text' => $question];
     }
-    
+
     file_put_contents('debug_log.txt', "User Message Parts: " . print_r($user_message_parts, true) . "\n", FILE_APPEND);
 
     // Basic validation
@@ -909,7 +1175,7 @@ try {
     if ($user_profile && $user_profile['primary_language'] && $user_profile['primary_language'] !== 'English') {
         $personalization_context .= "- The learner's primary language is **{$user_profile['primary_language']}** (though they're learning in English). Be mindful of potential language barriers.\n";
     }
-    
+
     // Session goal-based teaching instructions
     $session_goal_instructions = "";
     if ($session_goal) {
@@ -963,7 +1229,7 @@ The learner wants to practice and reinforce skills. Prioritize:
 EOT;
                 break;
         }
-        
+
         // Add session context if available
         if ($session_context) {
             $context_details = [];
@@ -984,7 +1250,7 @@ EOT;
             }
         }
     }
-    
+
     // Append session goal instructions to personalization context
     $personalization_context .= $session_goal_instructions;
 
@@ -1220,13 +1486,95 @@ PROMPT;
         $stmt = $pdo->prepare("INSERT INTO messages (conversation_id, role, content) VALUES (?, 'model', ?)");
         $stmt->execute([$conversation_id, json_encode([['text' => $answer]])]);
 
+        // --- HYBRID PROGRESS TRACKING ---
+        // Fetch and update context_data for this conversation
+        $stmt = $pdo->prepare("SELECT context_data, session_goal FROM conversations WHERE id = ?");
+        $stmt->execute([$conversation_id]);
+        $convoData = $stmt->fetch(PDO::FETCH_ASSOC);
+        $contextData = json_decode($convoData['context_data'] ?? '{}', true) ?: [];
+        $currentSessionGoal = $convoData['session_goal'] ?? $session_goal;
+
+        // Initialize message count if not set
+        $contextData['messageCount'] = ($contextData['messageCount'] ?? 0) + 1;
+
+        // Initialize comprehension score if not set
+        if (!isset($contextData['comprehensionScore'])) {
+            $contextData['comprehensionScore'] = 0.5; // Start neutral
+        }
+
+        // Analyze user message for comprehension signals
+        $comprehensionDelta = analyzeComprehension($question);
+        $contextData['comprehensionScore'] = max(0, min(1, $contextData['comprehensionScore'] + $comprehensionDelta));
+
+        // Generate learning outline if topic detected and no outline exists
+        if (!isset($contextData['outline']) && !empty($question)) {
+            // Extract topic from user's first substantive message or session context
+            $detectedTopic = $session_context['topic'] ?? null;
+
+            // If no explicit topic, try to extract from the question
+            if (!$detectedTopic && strlen($question) > 10) {
+                // Use the question itself as the topic for outline generation
+                // This works especially well for "I want to learn about X" type messages
+                if (preg_match('/(?:learn|teach me|explain|understand|study|help with|about)\s+(.{10,100})(?:\?|$|\.)/i', $question, $matches)) {
+                    $detectedTopic = trim($matches[1]);
+                } elseif ($contextData['messageCount'] <= 2) {
+                    // For early messages, use the full question as topic hint
+                    $detectedTopic = substr($question, 0, 100);
+                }
+            }
+
+            // Generate outline if we have a topic and a session goal
+            if ($detectedTopic && $currentSessionGoal) {
+                $educationLevel = $user_profile['education_level'] ?? 'High School';
+                $outline = generateLearningOutline($detectedTopic, $currentSessionGoal, $educationLevel, GEMINI_API_KEY);
+
+                if ($outline) {
+                    $contextData['outline'] = $outline;
+                    $contextData['topic'] = $detectedTopic;
+                    error_log("Generated learning outline for: $detectedTopic with " . count($outline['milestones']) . " milestones");
+                }
+            }
+        }
+
+        // If we have milestones, detect which were covered in this response
+        if (isset($contextData['outline']['milestones'])) {
+            $contextData['outline']['milestones'] = detectMilestoneCompletion(
+                $answer,
+                $contextData['outline']['milestones']
+            );
+            $contextData['outline']['lastUpdated'] = date('c');
+
+            // Count newly completed milestones for notification
+            $completedMilestones = array_filter(
+                $contextData['outline']['milestones'],
+                fn($m) => $m['completed'] ?? false
+            );
+            $contextData['milestonesCompleted'] = count($completedMilestones);
+            $contextData['milestonesTotal'] = count($contextData['outline']['milestones']);
+        }
+
+        // Calculate hybrid progress
+        $hybridProgress = calculateHybridProgress($contextData);
+        $contextData['calculatedProgress'] = $hybridProgress;
+
+        // Save updated context and progress to database
+        $stmt = $pdo->prepare("UPDATE conversations SET context_data = ?, progress = ?, updated_at = NOW() WHERE id = ?");
+        $stmt->execute([json_encode($contextData), $hybridProgress, $conversation_id]);
+
+        // Also update session_goal if provided and not already set
+        if ($session_goal && !$convoData['session_goal']) {
+            $stmt = $pdo->prepare("UPDATE conversations SET session_goal = ? WHERE id = ?");
+            $stmt->execute([$session_goal, $conversation_id]);
+        }
+        // --- END HYBRID PROGRESS TRACKING ---
+
         // For new chats, generate an AI title
         $generated_title = null;
-        if (count($chat_history) === 1) { 
+        if (count($chat_history) === 1) {
             // This is a new chat - generate a title using AI
             try {
                 $title_prompt = "Based on this user question: \"$question\"\n\nGenerate a very concise, descriptive title for this conversation in 3-5 words maximum. The title should capture the main topic or question. Respond with ONLY the title, nothing else.";
-                
+
                 $title_payload = json_encode([
                     "contents" => [
                         [
@@ -1235,18 +1583,18 @@ PROMPT;
                         ]
                     ]
                 ]);
-                
+
                 $title_response = callGeminiAPI($title_payload, GEMINI_API_KEY);
-                
+
                 if (isset($title_response['candidates'][0]['content']['parts'][0]['text'])) {
                     $generated_title = trim($title_response['candidates'][0]['content']['parts'][0]['text']);
-                    
+
                     // Limit to 60 characters max and remove any quotes
                     $generated_title = str_replace(['"', "'"], '', $generated_title);
                     if (strlen($generated_title) > 60) {
                         $generated_title = substr($generated_title, 0, 57) . '...';
                     }
-                    
+
                     // Update the conversation title
                     $stmt = $pdo->prepare("UPDATE conversations SET title = ?, updated_at = NOW() WHERE id = ?");
                     $stmt->execute([$generated_title, $conversation_id]);
@@ -1260,13 +1608,35 @@ PROMPT;
 
         $formattedAnswer = formatResponse($answer);
         $response_payload = [
-            'success' => true, 
-            'answer' => $formattedAnswer, 
+            'success' => true,
+            'answer' => $formattedAnswer,
             'conversation_id' => $conversation_id
         ];
         if ($generated_title) {
             $response_payload['generated_title'] = $generated_title;
         }
+
+        // Include milestone progress in response for frontend
+        if (isset($contextData['outline'])) {
+            $completedMilestones = array_filter(
+                $contextData['outline']['milestones'] ?? [],
+                fn($m) => $m['completed'] ?? false
+            );
+            $response_payload['progress'] = [
+                'percentage' => $hybridProgress,
+                'milestonesCompleted' => count($completedMilestones),
+                'milestonesTotal' => count($contextData['outline']['milestones'] ?? []),
+                'comprehensionScore' => round($contextData['comprehensionScore'] ?? 0.5, 2),
+                'topic' => $contextData['topic'] ?? null,
+                // Include recently completed milestone titles for notification
+                'recentlyCompleted' => array_values(array_filter(
+                    $contextData['outline']['milestones'] ?? [],
+                    fn($m) => ($m['completed'] ?? false) &&
+                    isset($m['coveredAt']) &&
+                    (strtotime($m['coveredAt']) > strtotime('-1 minute'))
+                ))
+            ];
+        }
         if (empty($backgrounded)) {
             echo json_encode($response_payload);
             exit();
diff --git a/session-context.js b/session-context.js
index 5707577..61fdf8f 100644
--- a/session-context.js
+++ b/session-context.js
@@ -10,11 +10,11 @@ class SessionContextManager {
         this.currentSession = null;
         this.saveTimeout = null;
         this.SAVE_DEBOUNCE_MS = 1000;
-        
+
         // Load session from storage if available
         this.loadFromStorage();
     }
-    
+
     /**
      * Create a new session with a learning goal
      * @param {string} goal - 'homework_help' | 'test_prep' | 'explore' | 'practice' | null
@@ -32,9 +32,9 @@ class SessionContextManager {
                     context_data: initialContext
                 })
             });
-            
+
             const data = await response.json();
-            
+
             if (data.success && data.conversation_id) {
                 this.currentSession = {
                     id: data.conversation_id,
@@ -45,15 +45,15 @@ class SessionContextManager {
                     messageCount: 0,
                     startTime: new Date().toISOString()
                 };
-                
+
                 this.saveToStorage();
                 return this.currentSession;
             }
-            
+
             throw new Error(data.error || 'Failed to create session');
         } catch (error) {
             console.error('Session creation failed:', error);
-            
+
             // Fallback: create local session without server sync
             this.currentSession = {
                 id: null,
@@ -64,12 +64,12 @@ class SessionContextManager {
                 messageCount: 0,
                 startTime: new Date().toISOString()
             };
-            
+
             this.saveToStorage();
             return this.currentSession;
         }
     }
-    
+
     /**
      * Load an existing session by ID
      * @param {string} sessionId - The conversation ID
@@ -78,7 +78,7 @@ class SessionContextManager {
         try {
             const response = await fetch(`server_mysql.php?action=get_conversation&id=${sessionId}`);
             const data = await response.json();
-            
+
             if (data.success && data.conversation) {
                 this.currentSession = {
                     id: sessionId,
@@ -89,81 +89,208 @@ class SessionContextManager {
                     messageCount: data.conversation.chat_history?.length || 0,
                     title: data.conversation.title
                 };
-                
+
                 this.saveToStorage();
                 return this.currentSession;
             }
         } catch (error) {
             console.error('Failed to load session:', error);
         }
-        
+
         return null;
     }
-    
+
     /**
      * Update session context (debounced API save)
      * @param {object} contextData - Context fields to update
      */
     updateContext(contextData) {
         if (!this.currentSession) return;
-        
+
         // Merge with existing context
         this.currentSession.context = {
             ...this.currentSession.context,
             ...contextData
         };
-        
+
         this.saveToStorage();
         this.debouncedSave();
     }
-    
+
     /**
      * Update session progress
      * @param {number} progress - Progress percentage (0-100)
      */
     updateProgress(progress) {
         if (!this.currentSession) return;
-        
+
         this.currentSession.progress = Math.max(0, Math.min(100, progress));
         this.currentSession.completed = progress >= 95;
-        
+
         this.saveToStorage();
         this.debouncedSave();
     }
-    
+
     /**
      * Increment message count and update progress for practice mode
+     * Note: Server now calculates hybrid progress, so this is a fallback
      */
     incrementMessageCount() {
         if (!this.currentSession) return;
-        
+
         this.currentSession.messageCount = (this.currentSession.messageCount || 0) + 1;
-        
-        // Auto-calculate progress based on goal
-        if (this.currentSession.goal === 'practice') {
-            const targetProblems = this.currentSession.context.problemCount || 10;
-            const problemsSolved = Math.floor(this.currentSession.messageCount / 2); // Rough estimate
-            const progress = Math.min(100, (problemsSolved / targetProblems) * 100);
-            this.currentSession.progress = progress;
-        } else if (this.currentSession.goal === 'explore') {
-            // Exploration progress based on conversation depth
-            const progress = Math.min(100, (this.currentSession.messageCount / 20) * 100);
-            this.currentSession.progress = progress;
+
+        // Only calculate client-side progress if no server-side milestones exist
+        if (!this.currentSession.context?.outline) {
+            const msgCount = this.currentSession.messageCount;
+
+            switch (this.currentSession.goal) {
+                case 'practice':
+                    const targetProblems = this.currentSession.context.problemCount || 10;
+                    const problemsSolved = Math.floor(msgCount / 2);
+                    this.currentSession.progress = Math.min(100, (problemsSolved / targetProblems) * 100);
+                    break;
+
+                case 'explore':
+                    this.currentSession.progress = Math.min(100, (msgCount / 20) * 100);
+                    break;
+
+                case 'homework_help':
+                    this.currentSession.progress = Math.min(100, (msgCount / 10) * 100);
+                    break;
+
+                case 'test_prep':
+                    this.currentSession.progress = Math.min(100, (msgCount / 15) * 100);
+                    break;
+
+                default:
+                    this.currentSession.progress = Math.min(100, (msgCount / 10) * 100);
+            }
+
+            this.currentSession.completed = this.currentSession.progress >= 95;
         }
-        
+
         this.saveToStorage();
+        this.debouncedSave();
     }
-    
+
     /**
-     * Extract context from user message using keyword detection
-     * @param {string} message - The user's message
+     * Update progress from server response (hybrid progress with milestones)
+     * @param {object} progressData - Progress data from server response
      */
+    updateFromServerProgress(progressData) {
+        if (!this.currentSession || !progressData) return;
+
+        // Update progress from server's hybrid calculation
+        this.currentSession.progress = progressData.percentage || this.currentSession.progress;
+        this.currentSession.completed = this.currentSession.progress >= 95;
+
+        // Store milestone data in context
+        if (!this.currentSession.context) {
+            this.currentSession.context = {};
+        }
+
+        this.currentSession.context.milestonesCompleted = progressData.milestonesCompleted;
+        this.currentSession.context.milestonesTotal = progressData.milestonesTotal;
+        this.currentSession.context.comprehensionScore = progressData.comprehensionScore;
+
+        if (progressData.topic) {
+            this.currentSession.context.topic = progressData.topic;
+        }
+
+        // Handle recently completed milestones for notification
+        if (progressData.recentlyCompleted && progressData.recentlyCompleted.length > 0) {
+            this.showMilestoneNotification(progressData.recentlyCompleted);
+        }
+
+        this.saveToStorage();
+    }
+
+    /**
+     * Show notification for completed milestones
+     * @param {array} milestones - Recently completed milestones
+     */
+    showMilestoneNotification(milestones) {
+        milestones.forEach(milestone => {
+            // Create and show a toast notification
+            this.createMilestoneToast(milestone);
+        });
+    }
+
+    /**
+     * Create a toast notification for a completed milestone
+     * @param {object} milestone - The completed milestone
+     */
+    createMilestoneToast(milestone) {
+        // Check if toast container exists, create if not
+        let toastContainer = document.getElementById('milestone-toast-container');
+        if (!toastContainer) {
+            toastContainer = document.createElement('div');
+            toastContainer.id = 'milestone-toast-container';
+            toastContainer.style.cssText = `
+                position: fixed;
+                top: 20px;
+                right: 20px;
+                z-index: 10000;
+                display: flex;
+                flex-direction: column;
+                gap: 10px;
+                max-width: 350px;
+            `;
+            document.body.appendChild(toastContainer);
+        }
+
+        const toast = document.createElement('div');
+        toast.className = 'milestone-toast';
+        toast.innerHTML = `
+            <div style="
+                background: linear-gradient(135deg, rgba(123, 63, 242, 0.95), rgba(78, 40, 153, 0.95));
+                backdrop-filter: blur(10px);
+                border-radius: 12px;
+                padding: 16px 20px;
+                box-shadow: 0 8px 32px rgba(123, 63, 242, 0.4);
+                border: 1px solid rgba(255, 255, 255, 0.1);
+                color: white;
+                animation: slideIn 0.3s ease-out;
+            ">
+                <div style="display: flex; align-items: center; gap: 12px;">
+                    <div style="
+                        width: 40px;
+                        height: 40px;
+                        background: rgba(255, 255, 255, 0.2);
+                        border-radius: 50%;
+                        display: flex;
+                        align-items: center;
+                        justify-content: center;
+                        font-size: 20px;
+                    ">Ô£ô</div>
+                    <div>
+                        <div style="font-size: 12px; opacity: 0.8; margin-bottom: 4px;">Milestone Completed!</div>
+                        <div style="font-weight: 600; font-size: 14px;">${milestone.title}</div>
+                    </div>
+                </div>
+            </div>
+        `;
+
+        toastContainer.appendChild(toast);
+
+        // Auto-remove after 4 seconds
+        setTimeout(() => {
+            toast.style.animation = 'slideOut 0.3s ease-in';
+            setTimeout(() => toast.remove(), 300);
+        }, 4000);
+    }
+
+    /**
+         * Extract context from user message using keyword detection
+         * @param {string} message - The user's message
+         */
     extractContextFromMessage(message) {
         if (!this.currentSession) return;
-        
+
         const lowerMessage = message.toLowerCase();
         const contextUpdates = {};
-        
+
         // Subject detection
         const subjectPatterns = {
             'Mathematics': /\b(math|algebra|calculus|geometry|trigonometry|statistics|arithmetic)\b/i,
@@ -174,20 +301,20 @@ class SessionContextManager {
             'English': /\b(english|grammar|writing|essay|literature|poetry|reading)\b/i,
             'History': /\b(history|historical|ancient|medieval|modern|world war|civilization)\b/i
         };
-        
+
         for (const [subject, pattern] of Object.entries(subjectPatterns)) {
             if (pattern.test(lowerMessage)) {
                 contextUpdates.subject = subject;
                 break;
             }
         }
-        
+
         // Topic extraction (simple heuristic - look for "about X" or "on X")
         const topicPatterns = [
             /(?:about|on|studying|learning|help with|working on)\s+([a-z\s]+?)(?:\.|,|$|\?|!)/i,
             /(?:topic is|subject is)\s+([a-z\s]+?)(?:\.|,|$|\?|!)/i
         ];
-        
+
         for (const pattern of topicPatterns) {
             const match = lowerMessage.match(pattern);
             if (match && match[1]) {
@@ -198,7 +325,7 @@ class SessionContextManager {
                 }
             }
         }
-        
+
         // Time/urgency detection for test prep
         if (this.currentSession.goal === 'test_prep') {
             const urgencyPatterns = [
@@ -207,7 +334,7 @@ class SessionContextManager {
                 { pattern: /\bin\s+(\d+)\s+days?\b/i, daysMatch: true },
                 { pattern: /\bnext\s+week\b/i, days: 7 }
             ];
-            
+
             for (const { pattern, days, daysMatch } of urgencyPatterns) {
                 const match = message.match(pattern);
                 if (match) {
@@ -220,7 +347,7 @@ class SessionContextManager {
                 }
             }
         }
-        
+
         // Difficulty detection for practice mode
         if (this.currentSession.goal === 'practice') {
             if (/\beasy\b|\bbeginner\b|\bsimple\b/i.test(lowerMessage)) {
@@ -230,22 +357,22 @@ class SessionContextManager {
             } else if (/\bmedium\b|\bmoderate\b|\bintermediate\b/i.test(lowerMessage)) {
                 contextUpdates.difficulty = 'medium';
             }
-            
+
             // Problem count detection
             const countMatch = lowerMessage.match(/(\d+)\s*(?:problems?|questions?)/i);
             if (countMatch) {
                 contextUpdates.problemCount = parseInt(countMatch[1]);
             }
         }
-        
+
         // Apply updates if any were found
         if (Object.keys(contextUpdates).length > 0) {
             this.updateContext(contextUpdates);
         }
-        
+
         return contextUpdates;
     }
-    
+
     /**
      * Get context for AI system prompt
      * @returns {object} Context object for building system prompt
@@ -254,7 +381,7 @@ class SessionContextManager {
         if (!this.currentSession) {
             return { goal: null, context: {} };
         }
-        
+
         return {
             goal: this.currentSession.goal,
             context: this.currentSession.context,
@@ -262,7 +389,7 @@ class SessionContextManager {
             messageCount: this.currentSession.messageCount
         };
     }
-    
+
     /**
      * Debounced save to server
      */
@@ -270,18 +397,18 @@ class SessionContextManager {
         if (this.saveTimeout) {
             clearTimeout(this.saveTimeout);
         }
-        
+
         this.saveTimeout = setTimeout(() => {
             this.saveToServer();
         }, this.SAVE_DEBOUNCE_MS);
     }
-    
+
     /**
      * Save current session to server
      */
     async saveToServer() {
         if (!this.currentSession || !this.currentSession.id) return;
-        
+
         try {
             // Update context
             await fetch('api/session_context.php?action=update_context', {
@@ -293,7 +420,7 @@ class SessionContextManager {
                     context_data: this.currentSession.context
                 })
             });
-            
+
             // Update progress
             await fetch('api/session_context.php?action=update_progress', {
                 method: 'POST',
@@ -307,20 +434,20 @@ class SessionContextManager {
             console.error('Failed to save session to server:', error);
         }
     }
-    
+
     /**
      * Save to local storage for resilience
      */
     saveToStorage() {
         if (!this.currentSession) return;
-        
+
         try {
             localStorage.setItem('tutormind_session', JSON.stringify(this.currentSession));
         } catch (error) {
             console.warn('Failed to save session to localStorage:', error);
         }
     }
-    
+
     /**
      * Load from local storage
      */
@@ -334,7 +461,7 @@ class SessionContextManager {
             console.warn('Failed to load session from localStorage:', error);
         }
     }
-    
+
     /**
      * Clear current session
      */
@@ -346,7 +473,7 @@ class SessionContextManager {
             // Ignore storage errors
         }
     }
-    
+
     /**
      * Get human-readable title for goal
      */
@@ -359,21 +486,21 @@ class SessionContextManager {
         };
         return titles[goal] || 'New Chat';
     }
-    
+
     /**
      * Capitalize first letter of string
      */
     capitalizeFirstLetter(str) {
         return str.charAt(0).toUpperCase() + str.slice(1);
     }
-    
+
     /**
      * Get current session
      */
     getSession() {
         return this.currentSession;
     }
-    
+
     /**
      * Set conversation ID (for when session is created by quick-start)
      */
diff --git a/tutor_mysql.js b/tutor_mysql.js
index 0580326..19c72f3 100644
--- a/tutor_mysql.js
+++ b/tutor_mysql.js
@@ -21,7 +21,7 @@ document.addEventListener('DOMContentLoaded', async () => {
     // This ensures settings (especially dark mode) are applied before page renders
     window.settingsManager = new SettingsManager();
     window.settingsManager.init();
-    
+
     // Load settings immediately and wait for them to apply
     try {
         await window.settingsManager.loadSettings();
@@ -61,14 +61,14 @@ document.addEventListener('DOMContentLoaded', async () => {
     // --- Dark Mode Logic ---
     // Note: Dark mode is now managed by the SettingsManager and loaded from the database.
     // The toggle in the user menu will update both the UI and the database.
-    
+
     // Listen for dark mode toggle changes in the main UI
     if (darkModeToggle) {
         darkModeToggle.addEventListener('change', async () => {
             const isDark = darkModeToggle.checked;
             document.body.classList.toggle('dark-mode', isDark);
             localStorage.setItem('darkMode', isDark ? 'enabled' : 'disabled');
-            
+
             // Save to database via settings manager
             if (window.settingsManager) {
                 await window.settingsManager.debouncedSave({ dark_mode: isDark });
@@ -84,7 +84,7 @@ document.addEventListener('DOMContentLoaded', async () => {
 
         const messageBubble = document.createElement('div');
         messageBubble.classList.add('message-bubble');
-        
+
         messageWrapper.appendChild(messageBubble);
         chatMessages.appendChild(messageWrapper);
 
@@ -110,7 +110,7 @@ document.addEventListener('DOMContentLoaded', async () => {
         bubbles.forEach(bubble => {
             const wrapper = bubble.closest('.chat-message');
             const isAi = wrapper.classList.contains('ai-message');
-            
+
             // For AI messages, ensure footer buttons exist
             if (isAi && !bubble.querySelector('.message-footer')) {
                 const footer = document.createElement('div');
@@ -125,7 +125,7 @@ document.addEventListener('DOMContentLoaded', async () => {
                 `;
                 bubble.appendChild(footer);
             }
-            
+
             finalizeMessage(bubble);
         });
     }
@@ -134,7 +134,7 @@ document.addEventListener('DOMContentLoaded', async () => {
     function finalizeMessage(messageBubble) {
         // Add copy buttons to code blocks and trigger syntax highlighting
         addCopyButtonsToCodeBlocks(messageBubble);
-        
+
         // Scroll to the bottom one last time
         chatMessages.scrollTop = chatMessages.scrollHeight;
 
@@ -148,14 +148,14 @@ document.addEventListener('DOMContentLoaded', async () => {
                 }).catch((err) => {
                     console.error('MathJax typeset failed:', err);
                 });
-            } 
+            }
             // MathJax v2 fallback
             else if (MathJax.Hub && MathJax.Hub.Queue) {
                 MathJax.Hub.Queue(["Typeset", MathJax.Hub, messageBubble]);
             }
         }
     }
-    
+
     // --- Event Delegation for Chat Buttons ---
     // This replaces attachMessageEventListeners and works for all current and future buttons
     chatMessages.addEventListener('click', (e) => {
@@ -177,9 +177,9 @@ document.addEventListener('DOMContentLoaded', async () => {
         // 1. Parse the HTML into a virtual DOM
         const tempDiv = document.createElement('div');
         tempDiv.innerHTML = html;
-        
+
         const queue = [];
-        
+
         // 2. Traverse and build an action queue
         function traverse(node) {
             if (node.nodeType === Node.TEXT_NODE) {
@@ -194,30 +194,30 @@ document.addEventListener('DOMContentLoaded', async () => {
                     attributes[attr.name] = attr.value;
                 }
                 queue.push({ type: 'open', tagName, attributes });
-                
+
                 for (let child of node.childNodes) {
                     traverse(child);
                 }
-                
+
                 queue.push({ type: 'close' });
             }
         }
-        
+
         for (let child of tempDiv.childNodes) {
             traverse(child);
         }
-        
+
         // 3. Process the queue to animate
         let currentParent = element;
         const parentStack = [element];
-        
+
         function processQueue() {
             const chunkSize = 4; // Characters per tick
             let processed = 0;
-            
+
             while (queue.length > 0) {
                 const item = queue[0]; // Peek
-                
+
                 if (item.type === 'open') {
                     queue.shift();
                     const el = document.createElement(item.tagName);
@@ -236,7 +236,7 @@ document.addEventListener('DOMContentLoaded', async () => {
                 } else if (item.type === 'text') {
                     if (processed >= chunkSize) break; // Stop if chunk full
                     queue.shift();
-                    
+
                     if (currentParent.lastChild && currentParent.lastChild.nodeType === Node.TEXT_NODE) {
                         currentParent.lastChild.nodeValue += item.content;
                     } else {
@@ -245,44 +245,44 @@ document.addEventListener('DOMContentLoaded', async () => {
                     processed++;
                 }
             }
-            
+
             // Scroll to bottom
             const chatContainer = document.getElementById('chat-container');
-            if(chatContainer) chatContainer.scrollTop = chatContainer.scrollHeight;
-            
+            if (chatContainer) chatContainer.scrollTop = chatContainer.scrollHeight;
+
             if (queue.length > 0) {
                 setTimeout(processQueue, speed);
             } else {
                 if (callback) callback();
             }
         }
-        
+
         processQueue();
     }
 
     // --- Function to add copy buttons to code blocks ---
     function addCopyButtonsToCodeBlocks(container) {
         const codeBlocks = container.querySelectorAll('pre code');
-        
+
         // Apply syntax highlighting using lazy loader
         if (codeBlocks.length > 0 && window.syntaxHighlighter) {
             window.syntaxHighlighter.highlight(container).catch(err => {
                 console.warn('Syntax highlighting failed:', err);
             });
         }
-        
+
         // Add copy buttons
         container.querySelectorAll('pre').forEach(pre => {
             // Don't add button if it already exists
             if (pre.querySelector('.copy-code-btn')) return;
-            
+
             const button = document.createElement('button');
             button.className = 'copy-code-btn';
             button.textContent = 'Copy';
             button.addEventListener('click', () => {
                 const code = pre.querySelector('code') || pre;
                 const text = code.textContent;
-                
+
                 navigator.clipboard.writeText(text).then(() => {
                     button.textContent = 'Copied!';
                     setTimeout(() => {
@@ -295,7 +295,7 @@ document.addEventListener('DOMContentLoaded', async () => {
                     }, 2000);
                 });
             });
-            
+
             pre.appendChild(button);
         });
     }
@@ -318,7 +318,7 @@ document.addEventListener('DOMContentLoaded', async () => {
             } else {
                 // Stop any current speech
                 speechSynthesis.cancel();
-                
+
                 // Reset all other buttons
                 document.querySelectorAll('.read-aloud-btn[data-speaking="true"]').forEach(btn => {
                     btn.dataset.speaking = 'false';
@@ -426,7 +426,7 @@ document.addEventListener('DOMContentLoaded', async () => {
             this.previewArea = previewArea;
             this.maxFiles = maxFiles;
             this.files = []; // Store File objects here
-            
+
             this.init();
         }
 
@@ -473,7 +473,7 @@ document.addEventListener('DOMContentLoaded', async () => {
 
         updatePreview() {
             this.previewArea.innerHTML = '';
-            
+
             if (this.files.length === 0) {
                 this.previewArea.classList.remove('has-files');
                 return;
@@ -490,7 +490,7 @@ document.addEventListener('DOMContentLoaded', async () => {
                 // Thumbnail
                 const thumbnail = document.createElement('div');
                 thumbnail.className = 'attachment-thumbnail';
-                
+
                 if (file.type.startsWith('image/')) {
                     const img = document.createElement('img');
                     img.src = URL.createObjectURL(file);
@@ -555,7 +555,7 @@ document.addEventListener('DOMContentLoaded', async () => {
         // --- The Fix: Capture FormData immediately ---
         // This ensures we have the question and file data before any other operations.
         const formData = new FormData(tutorForm);
-        
+
         // Add session context to the request
         if (window.sessionContextManager) {
             const sessionContext = window.sessionContextManager.getSystemPromptContext();
@@ -590,7 +590,7 @@ document.addEventListener('DOMContentLoaded', async () => {
         if (welcomeScreen) welcomeScreen.style.display = 'none';
         document.body.classList.remove('chat-empty');
         if (conversationTitleEl) conversationTitleEl.style.display = 'block';
-        
+
         // Hide Quick Start overlay if visible
         const quickStartOverlay = document.getElementById('quick-start-overlay');
         if (quickStartOverlay && !quickStartOverlay.classList.contains('hidden')) {
@@ -631,9 +631,9 @@ document.addEventListener('DOMContentLoaded', async () => {
                     </div>
                 `;
                 addMessage('ai', messageContent, true);
-                
+
                 // Event listeners are now attached in finalizeMessage after typing is complete
-                
+
                 // Handle conversation ID and title updates
                 if (result.conversation_id) {
                     conversationIdInput.value = result.conversation_id;
@@ -643,7 +643,7 @@ document.addEventListener('DOMContentLoaded', async () => {
                         const baseUrl = window.location.pathname.split('/chat')[0];
                         history.pushState({}, '', `${baseUrl}/chat/${result.conversation_id}`);
                     }
-                    
+
                     // If server generated a title, update the conversation in the sidebar
                     if (result.generated_title) {
                         console.log('AI generated title:', result.generated_title);
@@ -659,6 +659,13 @@ document.addEventListener('DOMContentLoaded', async () => {
                         }
                     }
                 }
+
+                // Update session context with server-side progress data (hybrid progress with milestones)
+                if (result.progress && window.sessionContextManager) {
+                    window.sessionContextManager.updateFromServerProgress(result.progress);
+                    console.log('Progress updated:', result.progress.percentage + '%',
+                        `(${result.progress.milestonesCompleted}/${result.progress.milestonesTotal} milestones)`);
+                }
             } else {
                 addMessage('ai', `<p style="color: red;">Error: ${result.error || 'An unknown error occurred.'}</p>`);
             }
@@ -687,14 +694,14 @@ document.addEventListener('DOMContentLoaded', async () => {
         welcomeScreen.style.display = 'flex';
         conversationIdInput.value = '';
         highlightActiveConversation(null);
-        
+
         // Reset conversation title to default and hide it
         if (conversationTitleEl) {
             conversationTitleEl.textContent = 'TutorMind';
             conversationTitleEl.style.display = 'none';
         }
         document.body.classList.add('chat-empty');
-        
+
         // Clear session context
         if (window.sessionContextManager) {
             window.sessionContextManager.clear();
@@ -715,7 +722,7 @@ document.addEventListener('DOMContentLoaded', async () => {
         const username = greetingElement.dataset.username || 'Friend';
         const hour = new Date().getHours();
         let timeGreeting = "Hello";
-        
+
         if (hour >= 5 && hour < 12) {
             timeGreeting = "Good morning";
         } else if (hour >= 12 && hour < 18) {
@@ -735,14 +742,14 @@ document.addEventListener('DOMContentLoaded', async () => {
             "Ready when you are",
             "Ready to lock in",
         ];
-        
+
         const randomGreeting = greetings[Math.floor(Math.random() * greetings.length)];
         const fullText = `${randomGreeting}, ${username}!`;
-        
+
         // Custom variable-speed typing for a smoother, more natural feel
         let i = 0;
         greetingElement.textContent = ''; // Clear initial content
-        
+
         function typeChar() {
             if (i < fullText.length) {
                 greetingElement.textContent += fullText.charAt(i);
@@ -752,7 +759,7 @@ document.addEventListener('DOMContentLoaded', async () => {
                 setTimeout(typeChar, delay);
             }
         }
-        
+
         typeChar();
     }
 
@@ -768,17 +775,17 @@ document.addEventListener('DOMContentLoaded', async () => {
 
             if (data.success && data.suggestions) {
                 const pills = document.querySelectorAll('.suggestion-pill');
-                
+
                 // Update pills based on the returned keys
                 pills.forEach(pill => {
                     const iconText = pill.querySelector('.pill-icon').nextSibling.textContent.trim().toLowerCase();
                     let key = '';
-                    
+
                     if (iconText.includes('explain')) key = 'explain';
                     else if (iconText.includes('write')) key = 'write';
                     else if (iconText.includes('build')) key = 'build';
                     else if (iconText.includes('research')) key = 'research';
-                    
+
                     if (key && data.suggestions[key]) {
                         pill.dataset.prompt = data.suggestions[key];
                         // Optional: Add a subtle animation to show update
@@ -853,8 +860,23 @@ document.addEventListener('DOMContentLoaded', async () => {
         try {
             // Use absolute path for fetch to avoid issues when current URL is /chat/123
             const fetchUrl = window.location.pathname.split('/chat')[0] + '/server_mysql.php';
-            const response = await fetch(`${fetchUrl}?action=get_conversation&id=${id}`);
+            const response = await fetch(`${fetchUrl}?action=get_conversation&id=${id}`, {
+                method: 'GET',
+                credentials: 'include', // Ensure cookies are sent
+                headers: {
+                    'Accept': 'application/json'
+                }
+            });
+
+            // Check if response is OK
+            if (!response.ok) {
+                console.error('Server returned error:', response.status, response.statusText);
+                throw new Error(`Server error: ${response.status}`);
+            }
+
             const text = await response.text();
+            console.log('Raw response:', text.substring(0, 200)); // Debug log
+
             let result;
             try {
                 result = JSON.parse(text);
@@ -949,12 +971,12 @@ document.addEventListener('DOMContentLoaded', async () => {
                         // Attach event listener to the new button
                         const newButton = chatMessages.lastElementChild.querySelector('.read-aloud-btn');
                         if (newButton) newButton.addEventListener('click', handleReadAloud);
-                            const newCopyButton = chatMessages.lastElementChild.querySelector('.copy-btn');
-                            if (newCopyButton) newCopyButton.addEventListener('click', handleCopyClick);
+                        const newCopyButton = chatMessages.lastElementChild.querySelector('.copy-btn');
+                        if (newCopyButton) newCopyButton.addEventListener('click', handleCopyClick);
                     }
                 });
                 highlightActiveConversation(id);
-                
+
                 // Update the conversation title in the header and show it
                 if (conversationTitleEl && result.conversation.title) {
                     conversationTitleEl.textContent = result.conversation.title;
@@ -1020,7 +1042,8 @@ document.addEventListener('DOMContentLoaded', async () => {
                     formData.append('id', id);
                     formData.append('title', newTitle);
 
-                    const response = await fetch('server_mysql.php', {
+                    const fetchUrl = window.location.pathname.split('/chat')[0] + '/server_mysql.php';
+                    const response = await fetch(fetchUrl, {
                         method: 'POST',
                         body: formData
                     });
@@ -1064,12 +1087,17 @@ document.addEventListener('DOMContentLoaded', async () => {
         }
     }
 
+    // --- Expose functions to global scope for SSR onclick handlers ---
+    window.loadConversation = loadConversation;
+    window.deleteConversation = deleteConversation;
+    window.enableRename = enableRename;
+
     // --- Sidebar Toggle (Desktop & Mobile) ---
     const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
-    
+
     if (sidebar) {
         const overlay = document.getElementById('sidebar-overlay');
-        
+
         // Restore state from localStorage on load (Desktop only)
         if (window.innerWidth > 768) {
             const isCollapsed = localStorage.getItem('sidebarCollapsed') === 'true';
@@ -1105,7 +1133,7 @@ document.addEventListener('DOMContentLoaded', async () => {
             sidebar.classList.remove('open');
             overlay.classList.add('hidden');
         });
-        
+
         // Handle resize to reset states if needed
         window.addEventListener('resize', () => {
             if (window.innerWidth > 768) {
@@ -1167,11 +1195,11 @@ document.addEventListener('DOMContentLoaded', async () => {
             }
         });
     }
-    
+
     // --- Tools Dropdown Menu ---
     const toolsBtn = document.getElementById('tools-btn');
     const toolsMenu = document.getElementById('tools-menu');
-    
+
     if (toolsBtn && toolsMenu) {
         // Toggle menu on button click
         toolsBtn.addEventListener('click', (e) => {
@@ -1179,7 +1207,7 @@ document.addEventListener('DOMContentLoaded', async () => {
             const isHidden = toolsMenu.classList.toggle('hidden');
             toolsBtn.setAttribute('aria-expanded', !isHidden);
         });
-        
+
         // Close menu when clicking outside
         document.addEventListener('click', (e) => {
             if (!toolsMenu.contains(e.target) && !toolsBtn.contains(e.target)) {
@@ -1187,10 +1215,10 @@ document.addEventListener('DOMContentLoaded', async () => {
                 toolsBtn.setAttribute('aria-expanded', 'false');
             }
         });
-        
+
         // Handle menu item clicks
         const toolsMenuItems = toolsMenu.querySelectorAll('.tools-menu-item');
-        
+
         // Prompt templates for each goal
         const promptTemplates = {
             homework_help: "Help me with my homework on ",
@@ -1198,11 +1226,11 @@ document.addEventListener('DOMContentLoaded', async () => {
             explore: "I want to learn more about ",
             practice: "Give me practice problems on "
         };
-        
+
         toolsMenuItems.forEach(item => {
             item.addEventListener('click', () => {
                 const goal = item.dataset.goal;
-                
+
                 // Set the session goal using SessionContextManager
                 if (window.sessionContextManager) {
                     window.sessionContextManager.create(goal).then(session => {
@@ -1211,14 +1239,14 @@ document.addEventListener('DOMContentLoaded', async () => {
                         }
                     });
                 }
-                
+
                 // Insert prompt template into input
                 const template = promptTemplates[goal] || '';
                 questionInput.value = template;
-                
+
                 // Close the menu
                 toolsMenu.classList.add('hidden');
-                
+
                 // Focus the input and place cursor at the end
                 questionInput.focus();
                 questionInput.setSelectionRange(template.length, template.length);
diff --git a/ui-overhaul.css b/ui-overhaul.css
index 4e1148c..b552f60 100644
--- a/ui-overhaul.css
+++ b/ui-overhaul.css
@@ -30,13 +30,12 @@ TutorMind UI Overhaul - 2025 Refresh
 body {
   font-family: "Outfit", "Source Sans Pro", -apple-system, BlinkMacSystemFont,
     "Segoe UI", Roboto, sans-serif;
-  background: linear-gradient(135deg, 
-    #e8e0f5 0%,
-    #e8d5e0 25%,
-    #d8b5a8 50%,
-    #c88060 75%,
-    #8B4513 100%
-  );
+  background: linear-gradient(135deg,
+      #e8e0f5 0%,
+      #e8d5e0 25%,
+      #d8b5a8 50%,
+      #c88060 75%,
+      #8B4513 100%);
   color: var(--text-primary);
   overflow: hidden;
   -webkit-font-smoothing: antialiased;
@@ -71,12 +70,15 @@ body {
 .h-screen {
   height: 100vh;
 }
+
 .flex {
   display: flex;
 }
+
 .hidden {
   display: none !important;
 }
+
 .hidden-input {
   position: absolute;
   width: 1px;
@@ -92,10 +94,12 @@ body {
 /* --- Sidebar --- */
 .sidebar {
   width: 260px;
-  background: rgba(255, 255, 255, 0.75); /* Balanced blend */
+  background: rgba(255, 255, 255, 0.75);
+  /* Balanced blend */
   backdrop-filter: blur(20px) saturate(150%);
   -webkit-backdrop-filter: blur(20px) saturate(150%);
-  border-right: 1px solid rgba(255, 255, 255, 0.1); /* More subtle border */
+  border-right: 1px solid rgba(255, 255, 255, 0.1);
+  /* More subtle border */
   box-shadow: 2px 0 15px rgba(0, 0, 0, 0.08);
   color: var(--text-primary);
   display: flex;
@@ -103,18 +107,22 @@ body {
   flex-shrink: 0;
   transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
   z-index: 200;
-  overflow: visible; /* Allow menu to extend beyond sidebar */
+  overflow: visible;
+  /* Allow menu to extend beyond sidebar */
   white-space: nowrap;
 }
 
 .sidebar.collapsed {
   width: 80px;
-  overflow: visible; /* Allow modal menu to break out */
+  overflow: visible;
+  /* Allow modal menu to break out */
 }
 
 .sidebar.collapsed .app-logo-text,
-.sidebar.collapsed .new-chat-btn span, /* Assuming text is wrapped or I'll wrap it */
-.sidebar.collapsed .user-info-button .user-details, /* Only hide button's user-details */
+.sidebar.collapsed .new-chat-btn span,
+/* Assuming text is wrapped or I'll wrap it */
+.sidebar.collapsed .user-info-button .user-details,
+/* Only hide button's user-details */
 .sidebar.collapsed #user-account-chevron,
 .sidebar.collapsed .chat-history {
   opacity: 0;
@@ -132,7 +140,7 @@ body {
 
 /* Ensure all menu CONTENT is fully visible when sidebar is collapsed and menu is shown */
 /* Don't force the menu itself to show - let JS handle that via .hidden class */
-.sidebar.collapsed .user-menu > * {
+.sidebar.collapsed .user-menu>* {
   opacity: 1 !important;
   pointer-events: auto !important;
 }
@@ -285,7 +293,8 @@ body {
   padding: 1rem 1.25rem;
   border-top: 1px solid var(--border);
   position: relative;
-  margin-top: auto; /* Push to bottom */
+  margin-top: auto;
+  /* Push to bottom */
 }
 
 .user-info-button {
@@ -322,7 +331,7 @@ body {
 .user-details {
   flex-grow: 1;
   overflow: hidden;
- /* margin-left: 3px; */ 
+  /* margin-left: 3px; */
 }
 
 .user-details h4 {
@@ -355,13 +364,16 @@ body {
   bottom: calc(100% - 0.5rem);
   left: 1.25rem;
   right: 1.25rem;
-  min-width: 260px; /* Ensure full width */
-  background-color: rgba(255, 255, 255, 0.95); /* Light mode background */
+  min-width: 260px;
+  /* Ensure full width */
+  background-color: rgba(255, 255, 255, 0.95);
+  /* Light mode background */
   backdrop-filter: blur(20px);
   -webkit-backdrop-filter: blur(20px);
   border-radius: 8px;
   box-shadow: 0 -10px 25px rgba(0, 0, 0, 0.1);
-  z-index: 1000; /* High z-index for overlay */
+  z-index: 1000;
+  /* High z-index for overlay */
   border: 1px solid var(--border);
   overflow: hidden;
   color: var(--text-primary);
@@ -374,15 +386,18 @@ body {
 /* When sidebar is collapsed, show menu as modal near the button */
 .sidebar.collapsed .user-menu {
   position: fixed;
-  left: 10px; /* Slightly closer to collapsed sidebar */
-  bottom: 80px; /* Position above user profile */
+  left: 10px;
+  /* Slightly closer to collapsed sidebar */
+  bottom: 80px;
+  /* Position above user profile */
   top: auto;
   right: auto;
   transform: none;
   width: 280px;
   max-width: 90vw;
   box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
-  z-index: 2000; /* Above everything */
+  z-index: 2000;
+  /* Above everything */
 }
 
 .user-menu-header {
@@ -417,6 +432,7 @@ body {
 .user-menu-nav a.logout-btn {
   color: var(--secondary-light);
 }
+
 .user-menu-nav a.logout-btn:hover {
   background-color: rgba(255, 107, 53, 0.1);
   color: var(--secondary);
@@ -427,6 +443,7 @@ body {
   cursor: pointer;
   border-radius: 6px;
 }
+
 .dark-mode-toggle:hover {
   background-color: rgba(0, 0, 0, 0.05);
 }
@@ -462,11 +479,11 @@ body {
   border-radius: 50%;
 }
 
-.toggle-switch input:checked + .slider {
+.toggle-switch input:checked+.slider {
   background-color: var(--secondary);
 }
 
-.toggle-switch input:checked + .slider:before {
+.toggle-switch input:checked+.slider:before {
   transform: translateX(16px);
 }
 
@@ -478,7 +495,8 @@ body {
   height: 100vh;
   background: transparent;
   position: relative;
-  overflow-x: hidden; /* Prevent horizontal scroll */
+  overflow-x: hidden;
+  /* Prevent horizontal scroll */
 }
 
 .main-chat-header {
@@ -510,7 +528,8 @@ body {
 }
 
 .sidebar.collapsed .app-logo {
-  display: none !important; /* Hide logo completely when collapsed */
+  display: none !important;
+  /* Hide logo completely when collapsed */
 }
 
 .sidebar.collapsed .sidebar-top-row {
@@ -557,11 +576,13 @@ body {
 }
 
 @keyframes pulse-glow {
+
   0%,
   100% {
     transform: scale(1);
     opacity: 0.8;
   }
+
   50% {
     transform: scale(1.1);
     opacity: 1;
@@ -569,13 +590,15 @@ body {
 }
 
 .welcome-section h1 {
-  font-size: 3rem; /* Slightly larger for desktop */
+  font-size: 3rem;
+  /* Slightly larger for desktop */
   font-weight: 700;
   background: linear-gradient(90deg, #4285f4, #9b72cb, #d96570);
   -webkit-background-clip: text;
   -webkit-text-fill-color: transparent;
   background-clip: text;
-  color: transparent; /* Fallback */
+  color: transparent;
+  /* Fallback */
   margin-bottom: 0.5rem;
   line-height: 1.2;
 }
@@ -588,7 +611,8 @@ body {
 
 /* Horizontal Suggestion Pills Row */
 .suggestion-pills-row {
-  display: none; /* Hidden by default (active chat) */
+  display: none;
+  /* Hidden by default (active chat) */
   gap: 12px;
   justify-content: center;
   flex-wrap: wrap;
@@ -646,22 +670,27 @@ body.chat-empty .suggestion-pills-row {
 
 @media (max-width: 768px) {
   .chat-message {
-    max-width: 95%; /* Wider bubbles on mobile */
+    max-width: 95%;
+    /* Wider bubbles on mobile */
     margin-bottom: 1rem;
   }
-  
+
   .message-bubble {
-    padding: 1rem 1.25rem; /* Slightly less padding */
+    padding: 1rem 1.25rem;
+    /* Slightly less padding */
     font-size: 0.95rem;
   }
 }
+
 .user-message {
   margin-left: auto;
   flex-direction: row-reverse;
 }
+
 .ai-message {
   margin-right: auto;
 }
+
 .message-bubble {
   padding: 1.25rem 1.5rem;
   border-radius: 18px;
@@ -720,29 +749,35 @@ body.chat-empty .suggestion-pills-row {
   padding: 1rem 1.25rem;
   border-radius: 8px;
   overflow-x: auto;
-  max-width: 100%; /* Ensure it doesn't overflow parent */
-  
+  max-width: 100%;
+  /* Ensure it doesn't overflow parent */
+
   /* Default desktop style: scrollable */
-  white-space: pre; 
-  
+  white-space: pre;
+
   font-family: 'Courier New', Consolas, Monaco, monospace;
   font-size: 0.9rem;
   line-height: 1.5;
-  border: 1px solid rgba(0, 0, 0, 0.1); /* Subtle border for light mode */
+  border: 1px solid rgba(0, 0, 0, 0.1);
+  /* Subtle border for light mode */
 }
 
 @media (max-width: 768px) {
   .message-bubble pre {
     /* Mobile style: wrap text to prevent horizontal scroll breaking layout */
-    white-space: pre-wrap !important; 
-    word-break: break-all !important; /* Force break anywhere if needed */
+    white-space: pre-wrap !important;
+    word-break: break-all !important;
+    /* Force break anywhere if needed */
     overflow-wrap: break-word !important;
-    overflow-x: hidden !important; /* Hide scrollbar since we are wrapping */
-    padding: 0.75rem; /* Slightly less padding */
-    font-size: 0.85rem; /* Slightly smaller font */
+    overflow-x: hidden !important;
+    /* Hide scrollbar since we are wrapping */
+    padding: 0.75rem;
+    /* Slightly less padding */
+    font-size: 0.85rem;
+    /* Slightly smaller font */
     max-width: 100% !important;
   }
-  
+
   .message-bubble pre code {
     white-space: pre-wrap !important;
     word-break: break-all !important;
@@ -803,9 +838,12 @@ body.chat-empty .suggestion-pills-row {
   color: var(--text-on-primary);
   border-bottom-right-radius: 4px;
 }
+
 .ai-message .message-bubble {
-  background-color: transparent; /* Blend with main background */
-  border: 1px solid transparent; /* Remove border for seamless look */
+  background-color: transparent;
+  /* Blend with main background */
+  border: 1px solid transparent;
+  /* Remove border for seamless look */
   color: var(--text-primary);
   border-bottom-left-radius: 4px;
 }
@@ -814,6 +852,7 @@ body.chat-empty .suggestion-pills-row {
 #typing-indicator .message-bubble {
   padding: 12px 18px;
 }
+
 .typing-indicator span {
   height: 8px;
   width: 8px;
@@ -822,18 +861,23 @@ body.chat-empty .suggestion-pills-row {
   display: inline-block;
   animation: wave 1.3s infinite;
 }
+
 .typing-indicator span:nth-of-type(2) {
   animation-delay: -1.1s;
 }
+
 .typing-indicator span:nth-of-type(3) {
   animation-delay: -0.9s;
 }
+
 @keyframes wave {
+
   0%,
   60%,
   100% {
     transform: initial;
   }
+
   30% {
     transform: translateY(-8px);
   }
@@ -845,22 +889,24 @@ body.chat-empty .suggestion-pills-row {
   background: transparent;
   flex-shrink: 0;
   transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease;
-  transform: translateY(0); /* Default position (at bottom when chat is active) */
+  transform: translateY(0);
+  /* Default position (at bottom when chat is active) */
 }
 
 /* Gemini-style Centered Input with Smooth Vertical Slide */
 @media (min-width: 769px) {
+
   /* Base: input always at bottom in normal flow, but we'll transform it */
   .input-bar-area {
     position: relative;
     transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
   }
-  
+
   /* When chat is NOT empty: at bottom (no transform) */
   body:not(.chat-empty) .input-bar-area {
     transform: translateY(0);
   }
-  
+
   /* When chat is empty: slide UP to center of screen */
   body.chat-empty .input-bar-area {
     transform: translateY(calc(-50vh + 50%));
@@ -868,11 +914,12 @@ body.chat-empty .suggestion-pills-row {
 
   body.chat-empty .welcome-section {
     justify-content: center;
-    height: 40vh; /* Reduced to leave space for input */
+    height: 40vh;
+    /* Reduced to leave space for input */
     padding-bottom: 0;
     padding-top: 2rem;
   }
-  
+
   body.chat-empty .gradient-orb {
     margin-bottom: 1.5rem;
   }
@@ -886,7 +933,8 @@ body.chat-empty .suggestion-pills-row {
 
 .combined-input-bar {
   display: flex;
-  flex-direction: column; /* Stack previews above input */
+  flex-direction: column;
+  /* Stack previews above input */
   align-items: stretch;
   background: rgba(255, 255, 255, 0.6);
   backdrop-filter: blur(20px);
@@ -896,14 +944,16 @@ body.chat-empty .suggestion-pills-row {
   /* padding removed from here, moved to children */
   box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
   transition: all 0.3s ease;
-  overflow: visible; /* Allow dropdowns to overflow */
+  overflow: visible;
+  /* Allow dropdowns to overflow */
 }
 
 .input-row {
   display: flex;
   align-items: center;
   gap: 12px;
-  padding: 8px 12px; /* Original padding */
+  padding: 8px 12px;
+  /* Original padding */
   width: 100%;
 }
 
@@ -1128,10 +1178,12 @@ body.dark-mode .tools-menu {
   justify-content: center;
   transition: background-color 0.2s ease, transform 0.2s ease;
 }
+
 .send-btn:hover {
   background-color: var(--primary-dark);
   transform: scale(1.05);
 }
+
 .send-btn:disabled {
   background-color: #d1d5db;
   cursor: not-allowed;
@@ -1183,35 +1235,41 @@ body:not(.chat-empty) .setup-link-row {
     transform: translateX(-100%);
     transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
   }
+
   .sidebar.open {
     transform: translateX(0);
     box-shadow: 0 0 50px rgba(0, 0, 0, 0.3);
   }
+
   .sidebar-overlay {
     position: fixed;
     inset: 0;
     background-color: rgba(0, 0, 0, 0.5);
     z-index: 199;
   }
+
   .menu-toggle {
     display: block;
   }
+
   .main-chat-header {
     display: flex;
     justify-content: space-between;
     align-items: center;
     padding: 1rem;
     background: transparent;
-    position: relative; /* For absolute centering of logo */
+    position: relative;
+    /* For absolute centering of logo */
   }
-  
+
   .header-left {
     display: flex;
     align-items: center;
     gap: 12px;
-    z-index: 10; /* Ensure button is clickable */
+    z-index: 10;
+    /* Ensure button is clickable */
   }
-  
+
   /* Center the logo absolutely */
   .mobile-logo-link {
     position: absolute;
@@ -1221,7 +1279,7 @@ body:not(.chat-empty) .setup-link-row {
     text-align: center;
     z-index: 5;
   }
-  
+
   .mobile-logo-link .app-logo-text {
     background: linear-gradient(90deg, #4285f4, #9b72cb, #d96570);
     -webkit-background-clip: text;
@@ -1232,21 +1290,26 @@ body:not(.chat-empty) .setup-link-row {
   }
 
   .conversation-title {
-    display: none; /* Hide default title on mobile */
+    display: none;
+    /* Hide default title on mobile */
   }
-  
+
   /* Hide desktop elements */
   .desktop-only {
     display: none !important;
   }
+
   .suggestion-pills-row {
-    display: none !important; /* Hidden by default even on mobile */
-    grid-template-columns: 1fr 1fr; /* 2 columns */
+    display: none !important;
+    /* Hidden by default even on mobile */
+    grid-template-columns: 1fr 1fr;
+    /* 2 columns */
     gap: 8px;
     max-width: 100%;
     padding: 0 0.5rem;
     margin-bottom: 12px;
-    overflow-x: visible; /* No scrolling needed for grid */
+    overflow-x: visible;
+    /* No scrolling needed for grid */
     justify-content: stretch;
   }
 
@@ -1254,28 +1317,39 @@ body:not(.chat-empty) .setup-link-row {
   body.chat-empty .suggestion-pills-row {
     display: grid !important;
   }
+
   .suggestion-pills-row::-webkit-scrollbar {
     display: none;
   }
+
   .suggestion-pill {
-    width: 100% !important; /* Fill grid cell */
-    font-size: 0.8rem; /* Smaller font */
-    padding: 6px 10px; /* Smaller padding */
-    justify-content: center !important; /* Center content */
+    width: 100% !important;
+    /* Fill grid cell */
+    font-size: 0.8rem;
+    /* Smaller font */
+    padding: 6px 10px;
+    /* Smaller padding */
+    justify-content: center !important;
+    /* Center content */
     align-items: center;
-    gap: 5px !important; /* Reduce gap */
+    gap: 5px !important;
+    /* Reduce gap */
     white-space: nowrap;
     overflow: hidden;
     text-overflow: ellipsis;
     display: flex !important;
   }
+
   .chat-content {
     padding: 1rem;
-    padding-bottom: 160px; /* More space for the floating input bar */
-    overflow-x: hidden; /* Prevent horizontal scroll */
-    width: 100%; /* Ensure it fits width */
+    padding-bottom: 160px;
+    /* More space for the floating input bar */
+    overflow-x: hidden;
+    /* Prevent horizontal scroll */
+    width: 100%;
+    /* Ensure it fits width */
   }
-  
+
   /* Fix input bar on mobile - Floating App Style */
   .input-bar-area {
     position: fixed;
@@ -1283,48 +1357,55 @@ body:not(.chat-empty) .setup-link-row {
     left: 0;
     right: 0;
     padding: 0;
-    background: transparent; /* Remove full width background */
+    background: transparent;
+    /* Remove full width background */
     backdrop-filter: none;
     -webkit-backdrop-filter: none;
     border-top: none;
     z-index: 100;
     /* Ensure clicks pass through the empty area above input */
-    pointer-events: none; 
+    pointer-events: none;
   }
-  
+
   .unified-input-container {
     max-width: 100%;
     display: flex;
-    flex-direction: column-reverse; /* Pills ABOVE input */
+    flex-direction: column-reverse;
+    /* Pills ABOVE input */
     padding-bottom: calc(10px + env(safe-area-inset-bottom));
-    pointer-events: auto; /* Re-enable clicks for the form */
+    pointer-events: auto;
+    /* Re-enable clicks for the form */
   }
-  
+
   /* Mobile: Simplify user menu - hide account details, show just toggle */
   /* Mobile: Simplify user menu - hide account details, show just toggle */
   .sidebar .user-menu-trigger .user-info {
-    display: none !important; /* Hide username and email */
+    display: none !important;
+    /* Hide username and email */
   }
-  
+
   .sidebar .user-menu-trigger #user-account-chevron {
-    display: none !important; /* Hide chevron */
+    display: none !important;
+    /* Hide chevron */
   }
-  
+
   .sidebar .user-menu-trigger {
-    justify-content: center; /* Center the avatar */
+    justify-content: center;
+    /* Center the avatar */
     padding: 0.5rem;
   }
-  
+
   /* Make user menu dropdown simpler on mobile */
   .user-menu-dropdown a:not(.logout-link):not(#open-settings-btn) {
-    display: none; /* Hide upgrade plan link */
+    display: none;
+    /* Hide upgrade plan link */
   }
-  
+
   /* Keep dark mode toggle visible and styled properly */
   .dark-mode-toggle {
     width: 100%;
   }
-  
+
   /* CRITICAL FIX: Ensure user menu is properly hidden */
   .user-menu.hidden {
     display: none !important;
@@ -1332,25 +1413,29 @@ body:not(.chat-empty) .setup-link-row {
     opacity: 0 !important;
     pointer-events: none !important;
   }
-  
+
   /* Adjust z-index to prevent menu from covering content */
   .user-menu {
-    z-index: 1001; /* Below overlay but above sidebar */
+    z-index: 1001;
+    /* Below overlay but above sidebar */
   }
-  
+
   /* Ensure suggestion pills are above the menu when it's visible */
   .suggestion-pills-row {
     position: relative;
-    z-index: 50; /* Above chat content */
+    z-index: 50;
+    /* Above chat content */
   }
-  
+
   .combined-input-bar {
     margin: 0 16px;
-    background: rgba(255, 255, 255, 0.75); /* Goldilocks blend */
+    background: rgba(255, 255, 255, 0.75);
+    /* Goldilocks blend */
     backdrop-filter: blur(20px);
     -webkit-backdrop-filter: blur(20px);
     border: 1px solid var(--border);
-    border-radius: 32px; /* Pill shape */
+    border-radius: 32px;
+    /* Pill shape */
     padding: 8px 16px;
     gap: 12px;
     box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
@@ -1358,16 +1443,18 @@ body:not(.chat-empty) .setup-link-row {
     /* Ensure input bar doesn't get covered by keyboard on some devices */
     padding-bottom: max(8px, env(safe-area-inset-bottom));
   }
-  
+
   /* Adjust chat content padding to account for the fixed input bar */
   .chat-content {
     padding: 1rem;
-    padding-bottom: 140px; /* More space for the floating input bar */
+    padding-bottom: 140px;
+    /* More space for the floating input bar */
   }
-  
+
   /* Dark Mode Override for Input Bar */
   body.dark-mode .combined-input-bar {
-    background: rgba(30, 30, 46, 0.75); /* Dark Glass */
+    background: rgba(30, 30, 46, 0.75);
+    /* Dark Glass */
     border-color: rgba(255, 255, 255, 0.1);
     color: #fff;
     box-shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
@@ -1376,61 +1463,67 @@ body:not(.chat-empty) .setup-link-row {
   /* Extra responsiveness for smaller phones (iPhone 7+, etc.) */
   @media (max-width: 480px) {
     .combined-input-bar {
-      margin: 0 10px; /* Tighter margins */
+      margin: 0 10px;
+      /* Tighter margins */
       padding: 8px 12px;
     }
-    
+
     .suggestion-pills-row {
-      padding: 0 10px; /* Match input bar margin */
+      padding: 0 10px;
+      /* Match input bar margin */
     }
-    
+
     .chat-content {
       padding: 0.75rem;
       padding-bottom: 150px;
     }
-    
+
     /* Ensure user menu doesn't go off screen if opened */
     .sidebar.collapsed .user-menu {
       width: 260px;
       left: 5px;
     }
   }
-  
+
   /* Input text color */
   .main-text-input {
     color: var(--text-primary);
     font-size: 1rem;
   }
+
   .main-text-input::placeholder {
     color: var(--text-secondary);
   }
-  
+
   body.dark-mode .main-text-input {
     color: #fff;
   }
+
   body.dark-mode .main-text-input::placeholder {
     color: rgba(255, 255, 255, 0.5);
   }
-  
+
   /* Icons */
-  .add-btn, .voice-btn, .submit-btn {
+  .add-btn,
+  .voice-btn,
+  .submit-btn {
     color: var(--text-secondary);
     background: transparent;
     border: none;
   }
-  
-  body.dark-mode .add-btn, 
-  body.dark-mode .voice-btn, 
+
+  body.dark-mode .add-btn,
+  body.dark-mode .voice-btn,
   body.dark-mode .submit-btn {
     color: rgba(255, 255, 255, 0.8);
   }
-  
+
   /* Hide Tools and dropdown on mobile */
   .tools-btn,
   .control-dropdown {
     display: none;
   }
-  
+
   /* Remove forced dark background - respect user theme */
   /* body { background: ... } removed */
 
@@ -1444,19 +1537,23 @@ body:not(.chat-empty) .setup-link-row {
     margin-bottom: 20px;
     padding: 0 24px;
     display: grid;
-    grid-template-columns: 1fr 1fr; /* 2 columns */
+    grid-template-columns: 1fr 1fr;
+    /* 2 columns */
     gap: 12px;
     justify-content: center;
     overflow-x: visible;
     white-space: normal;
   }
-  
+
   .suggestion-pill {
     /* Stronger Glass effect for Light Mode */
-    background: rgba(255, 255, 255, 0.4); /* More transparent */
-    border: 1px solid rgba(255, 255, 255, 0.6); /* White border */
+    background: rgba(255, 255, 255, 0.4);
+    /* More transparent */
+    border: 1px solid rgba(255, 255, 255, 0.6);
+    /* White border */
     color: var(--text-primary);
-    backdrop-filter: blur(20px); /* Stronger blur */
+    backdrop-filter: blur(20px);
+    /* Stronger blur */
     -webkit-backdrop-filter: blur(20px);
     border-radius: 16px;
     padding: 5px;
@@ -1467,7 +1564,8 @@ body:not(.chat-empty) .setup-link-row {
     font-size: 0.9rem;
     width: 100%;
     height: 100%;
-    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05); /* Soft shadow */
+    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
+    /* Soft shadow */
     /*margin-right: 0px;*/
   }
 
@@ -1476,147 +1574,156 @@ body:not(.chat-empty) .setup-link-row {
     background: rgba(30, 30, 46, 0.70);
     border-color: rgba(255, 255, 255, 0.1);
   }
-  
+
   .suggestion-pill .pill-icon {
     font-size: 1.2rem;
   }
 
   /* Attachment Previews (Inside Input Bar) */
-/* Attachment Previews (Inside Input Bar) */
-#attachment-preview-area {
-  display: grid;
-  grid-template-rows: 0fr;
-  padding: 0;
-  border-bottom: 0 solid transparent;
-  transition: grid-template-rows 0.4s cubic-bezier(0.4, 0, 0.2, 1), 
-              padding 0.4s cubic-bezier(0.4, 0, 0.2, 1), 
-              border-bottom 0.4s cubic-bezier(0.4, 0, 0.2, 1);
-}
+  /* Attachment Previews (Inside Input Bar) */
+  #attachment-preview-area {
+    display: grid;
+    grid-template-rows: 0fr;
+    padding: 0;
+    border-bottom: 0 solid transparent;
+    transition: grid-template-rows 0.4s cubic-bezier(0.4, 0, 0.2, 1),
+      padding 0.4s cubic-bezier(0.4, 0, 0.2, 1),
+      border-bottom 0.4s cubic-bezier(0.4, 0, 0.2, 1);
+  }
 
-#attachment-preview-area.has-files {
-  grid-template-rows: 1fr;
-  padding: 12px 12px 4px 12px;
-  border-bottom: 1px solid rgba(123, 63, 242, 0.1);
-}
+  #attachment-preview-area.has-files {
+    grid-template-rows: 1fr;
+    padding: 12px 12px 4px 12px;
+    border-bottom: 1px solid rgba(123, 63, 242, 0.1);
+  }
 
-.attachment-preview-list {
-  min-height: 0;
-  display: flex;
-  flex-wrap: wrap;
-  gap: 8px;
-  max-height: 200px; /* Limit height */
-  overflow-y: auto; /* Scroll if too many */
-  /* Custom scrollbar for webkit */
-  scrollbar-width: thin;
-  scrollbar-color: rgba(123, 63, 242, 0.5) transparent;
-}
+  .attachment-preview-list {
+    min-height: 0;
+    display: flex;
+    flex-wrap: wrap;
+    gap: 8px;
+    max-height: 200px;
+    /* Limit height */
+    overflow-y: auto;
+    /* Scroll if too many */
+    /* Custom scrollbar for webkit */
+    scrollbar-width: thin;
+    scrollbar-color: rgba(123, 63, 242, 0.5) transparent;
+  }
 
-.attachment-preview-list::-webkit-scrollbar {
-  width: 4px;
-}
-.attachment-preview-list::-webkit-scrollbar-thumb {
-  background-color: rgba(123, 63, 242, 0.5);
-  border-radius: 4px;
-}
+  .attachment-preview-list::-webkit-scrollbar {
+    width: 4px;
+  }
 
+  .attachment-preview-list::-webkit-scrollbar-thumb {
+    background-color: rgba(123, 63, 242, 0.5);
+    border-radius: 4px;
+  }
 
 
-.attachment-card {
-  position: relative;
-  width: 60px;
-  height: 60px;
-  border-radius: 8px;
-  overflow: hidden;
-  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
-  background: #f0f0f0;
-  flex-shrink: 0;
-}
 
-.attachment-thumbnail {
-  width: 100%;
-  height: 100%;
-  display: flex;
-  align-items: center;
-  justify-content: center;
-}
+  .attachment-card {
+    position: relative;
+    width: 60px;
+    height: 60px;
+    border-radius: 8px;
+    overflow: hidden;
+    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
+    background: #f0f0f0;
+    flex-shrink: 0;
+  }
 
-.attachment-thumbnail img {
-  width: 100%;
-  height: 100%;
-  object-fit: cover;
-}
+  .attachment-thumbnail {
+    width: 100%;
+    height: 100%;
+    display: flex;
+    align-items: center;
+    justify-content: center;
+  }
 
-.attachment-thumbnail i {
-  font-size: 1.5rem;
-  color: var(--text-secondary);
-}
+  .attachment-thumbnail img {
+    width: 100%;
+    height: 100%;
+    object-fit: cover;
+  }
 
-.attachment-info {
-  display: none; /* Hide filename in compact view */
-}
+  .attachment-thumbnail i {
+    font-size: 1.5rem;
+    color: var(--text-secondary);
+  }
 
-.remove-attachment-btn {
-  position: absolute;
-  top: 2px;
-  right: 2px;
-  background: rgba(0, 0, 0, 0.6);
-  color: white;
-  border: none;
-  border-radius: 50%;
-  width: 16px;
-  height: 16px;
-  font-size: 10px;
-  display: flex;
-  align-items: center;
-  justify-content: center;
-  cursor: pointer;
-  opacity: 0;
-  transition: opacity 0.2s;
-}
+  .attachment-info {
+    display: none;
+    /* Hide filename in compact view */
+  }
+
+  .remove-attachment-btn {
+    position: absolute;
+    top: 2px;
+    right: 2px;
+    background: rgba(0, 0, 0, 0.6);
+    color: white;
+    border: none;
+    border-radius: 50%;
+    width: 16px;
+    height: 16px;
+    font-size: 10px;
+    display: flex;
+    align-items: center;
+    justify-content: center;
+    cursor: pointer;
+    opacity: 0;
+    transition: opacity 0.2s;
+  }
+
+  .attachment-card:hover .remove-attachment-btn {
+    opacity: 1;
+  }
 
-.attachment-card:hover .remove-attachment-btn {
-  opacity: 1;
-}
-  
   .submit-btn {
     width: 32px;
     height: 32px;
     font-size: 0.9rem;
-    background: rgba(255, 255, 255, 0.1); /* Circle background for send */
+    background: rgba(255, 255, 255, 0.1);
+    /* Circle background for send */
     border-radius: 50%;
     display: flex;
     align-items: center;
     justify-content: center;
   }
-  
+
   /* Old styles for compatibility */
   .input-form {
     gap: 0.5rem;
     max-width: 100%;
   }
+
   .text-input {
     padding: 10px;
   }
+
   .dropdown-btn {
-    display: none; /* Hide on mobile for simplicity */
+    display: none;
+    /* Hide on mobile for simplicity */
   }
-  
+
   /* Gemini-style Welcome Text on Mobile */
   .welcome-section h1 {
     background: linear-gradient(90deg, #4285f4, #9b72cb, #d96570);
     -webkit-background-clip: text;
     -webkit-text-fill-color: transparent;
     background-clip: text;
-    color: transparent; /* Fallback */
+    color: transparent;
+    /* Fallback */
     font-size: 2.2rem;
     line-height: 1.2;
   }
-  
+
   .welcome-section p {
     color: #888;
     font-size: 1.1rem;
   }
-  
+
   /* Adjust positioning for empty state on mobile */
   body.chat-empty .welcome-section {
     margin-top: 15vh;
@@ -1634,12 +1741,13 @@ body:not(.chat-empty) .setup-link-row {
   .mobile-only {
     display: block !important;
   }
-  
+
   /* Hide the sidebar's internal toggle on mobile if we want, 
      but keeping it as a 'close' button is better. 
      However, we might want to style it differently or hide it if it conflicts.
      For now, let's keep it. */
 }
+
 .copy-toast {
   position: fixed;
   left: 50%;
@@ -1656,9 +1764,11 @@ body:not(.chat-empty) .setup-link-row {
   opacity: 0;
   transition: opacity 0.3s ease;
 }
+
 #copy-toast[style*="display: block"] {
   opacity: 1;
 }
+
 .message-footer {
   margin-top: 10px;
   padding-top: 10px;
@@ -1666,6 +1776,7 @@ body:not(.chat-empty) .setup-link-row {
   display: flex;
   gap: 5px;
 }
+
 .message-footer button {
   background: none;
   border: 1px solid transparent;
@@ -1679,20 +1790,25 @@ body:not(.chat-empty) .setup-link-row {
   align-items: center;
   justify-content: center;
 }
+
 .message-footer button:hover {
   background-color: #f0eaff;
   color: var(--primary);
 }
+
 .user-message .message-footer {
   border-top: 1px solid rgba(255, 255, 255, 0.2);
 }
+
 .user-message .message-footer button {
   color: rgba(255, 255, 255, 0.7);
 }
+
 .user-message .message-footer button:hover {
   background-color: rgba(255, 255, 255, 0.2);
   color: white;
 }
+
 /* --- Attachment Previews (Gemini Style) --- */
 #attachment-preview-area {
   width: 100%;
@@ -1703,7 +1819,8 @@ body:not(.chat-empty) .setup-link-row {
   display: flex;
   gap: 12px;
   overflow-x: auto;
-  padding: 4px 4px 12px 4px; /* Bottom padding for scrollbar space/shadow */
+  padding: 4px 4px 12px 4px;
+  /* Bottom padding for scrollbar space/shadow */
   scrollbar-width: thin;
   scrollbar-color: rgba(0, 0, 0, 0.2) transparent;
 }
@@ -1815,16 +1932,15 @@ body.dark-mode {
   --text-secondary: #9ca3af;
   --border: #333333;
   --shadow-glow: 0 0 20px rgba(123, 63, 242, 0.4);
-  
+
   /* Dark mode gradient - deep purple to navy */
-  background: linear-gradient(135deg, 
-    #1a1625 0%,
-    #1f1a2e 25%,
-    #241e38 50%,
-    #2a2440 75%,
-    #2f2847 100%
-  );
-  
+  background: linear-gradient(135deg,
+      #1a1625 0%,
+      #1f1a2e 25%,
+      #241e38 50%,
+      #2a2440 75%,
+      #2f2847 100%);
+
   /* Dark Mode Scrollbar */
   scrollbar-color: rgba(255, 255, 255, 0.2) transparent;
 }
@@ -1851,6 +1967,7 @@ body.dark-mode .text-input {
   color: var(--text-primary);
   box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3), 0 1px 3px rgba(157, 107, 245, 0.2);
 }
+
 body.dark-mode .text-input:focus {
   background-color: #1e1e1e;
   border-color: var(--primary-light);
@@ -1863,6 +1980,7 @@ body.dark-mode .icon-btn {
   color: var(--text-secondary);
   box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4), 0 1px 3px rgba(157, 107, 245, 0.2);
 }
+
 body.dark-mode .icon-btn:hover {
   background-color: rgba(45, 45, 45, 0.9);
   border-color: var(--primary-light);
@@ -1875,6 +1993,7 @@ body.dark-mode .dropdown-btn {
   border-color: #444;
   color: var(--text-primary);
 }
+
 body.dark-mode .dropdown-btn:hover {
   background-color: #444;
   border-color: #555;
@@ -1948,16 +2067,20 @@ body.dark-mode .submit-btn:disabled {
 }
 
 body.dark-mode .ai-message .message-bubble {
-  background-color: transparent; /* Blend with main background */
-  border-color: transparent; /* Optional: remove border for seamless look, or keep var(--border) */
+  background-color: transparent;
+  /* Blend with main background */
+  border-color: transparent;
+  /* Optional: remove border for seamless look, or keep var(--border) */
 }
 
 body.dark-mode .message-footer {
   border-top-color: var(--border);
 }
+
 body.dark-mode .message-footer button {
   color: var(--text-secondary);
 }
+
 body.dark-mode .message-footer button:hover {
   background-color: #333;
   color: var(--primary-light);
@@ -1970,7 +2093,8 @@ body.dark-mode .message-bubble code {
 }
 
 body.dark-mode .message-bubble pre {
-  border: 1px solid rgba(255, 255, 255, 0.15); /* Subtle border for dark mode */
+  border: 1px solid rgba(255, 255, 255, 0.15);
+  /* Subtle border for dark mode */
 }
 
 body.dark-mode .message-bubble pre .copy-code-btn {
@@ -1991,14 +2115,14 @@ body.dark-mode #attachment-preview-area .attachment-display {
 
 /* Dark mode sidebar - deeper gradient with glassmorphism */
 body.dark-mode .sidebar {
-  background: linear-gradient(160deg, 
-    rgba(26, 22, 37, 0.9) 0%,
-    rgba(34, 26, 48, 0.9) 50%, 
-    rgba(42, 32, 64, 0.9) 100%
-  );
+  background: linear-gradient(160deg,
+      rgba(26, 22, 37, 0.9) 0%,
+      rgba(34, 26, 48, 0.9) 50%,
+      rgba(42, 32, 64, 0.9) 100%);
   backdrop-filter: blur(15px) saturate(180%);
   -webkit-backdrop-filter: blur(15px) saturate(180%);
-  border-right: 1px solid rgba(255, 255, 255, 0.05); /* Very subtle border for dark mode */
+  border-right: 1px solid rgba(255, 255, 255, 0.05);
+  /* Very subtle border for dark mode */
   box-shadow: 2px 0 20px rgba(0, 0, 0, 0.3);
   color: #e0e7ff;
 }
@@ -2076,9 +2200,11 @@ body.compact-mode .message-bubble li {
 body.compact-mode .chat-message {
   margin-bottom: 1rem;
 }
+
 body.compact-mode .input-bar-area {
   padding: 0.5rem 1rem;
 }
+
 body.compact-mode .main-chat-header {
   height: 50px;
 }
@@ -2169,10 +2295,13 @@ body.dark-mode .toggle-switch .slider {
 }
 
 @keyframes quick-start-pulse {
-  0%, 100% {
+
+  0%,
+  100% {
     transform: scale(1);
     opacity: 0.7;
   }
+
   50% {
     transform: scale(1.15);
     opacity: 1;
@@ -2443,9 +2572,182 @@ body:not(.dark-mode) .quick-start-overlay {
 }
 
 /* Hide old suggestion pills when Quick Start overlay is visible */
-.quick-start-overlay:not(.hidden) ~ .main-chat-wrapper .suggestion-pills-row,
+.quick-start-overlay:not(.hidden)~.main-chat-wrapper .suggestion-pills-row,
 body:has(.quick-start-overlay:not(.hidden)) .suggestion-pills-row {
   display: none !important;
 }
 
 
+
+/* 720p Laptop Optimization (Max Height: 800px) */
+@media (max-height: 800px) {
+
+  /* CRITICAL FIX: Slide input bar up much more aggressively for 720p */
+  body.chat-empty .input-bar-area {
+    transform: translateY(calc(-42vh + 50%));
+    /* Much closer to greeting */
+  }
+
+  /* Adjust welcome section for 720p - very compact */
+  body.chat-empty .welcome-section {
+    height: 20vh;
+    /* Very small to minimize gap */
+    padding-top: 0;
+    padding-bottom: 0;
+    min-height: auto;
+    margin-bottom: 0;
+  }
+
+  /* Welcome Section compacting */
+  .welcome-section {
+    padding: 0.5rem;
+    height: auto;
+    min-height: auto;
+    /* Remove min-height to prevent overlap */
+  }
+
+  .welcome-section h1 {
+    font-size: 2.25rem;
+    margin-bottom: 0.25rem;
+  }
+
+  .welcome-section p {
+    font-size: 0.95rem;
+    margin-bottom: 1.5rem;
+  }
+
+  .gradient-orb {
+    width: 60px;
+    height: 60px;
+    margin-bottom: 1rem;
+  }
+
+  /* Chat Messages Compact */
+  .chat-message {
+    margin-bottom: 1rem;
+  }
+
+  .message-bubble {
+    padding: 1rem 1.25rem;
+    font-size: 0.95rem;
+  }
+
+  .message-bubble h1,
+  .message-bubble h2 {
+    margin-top: 1rem;
+    margin-bottom: 0.5rem;
+  }
+
+  .message-bubble pre {
+    padding: 0.75rem 1rem;
+    margin: 0.75rem 0;
+  }
+
+  /* Sidebar Optimization */
+  .sidebar-header {
+    padding: 0.75rem;
+  }
+
+  .user-profile {
+    padding: 0.75rem;
+  }
+
+  .new-chat-btn {
+    padding: 10px;
+  }
+
+  .history-item a {
+    padding: 8px 10px;
+    font-size: 0.9rem;
+  }
+
+  .user-menu {
+    min-width: 240px;
+    bottom: calc(100% + 5px);
+    /* Ensure it goes up */
+  }
+
+  .user-menu-header {
+    padding: 0.75rem;
+  }
+
+  .user-menu-nav a,
+  .dark-mode-toggle {
+    padding: 8px 10px;
+  }
+
+  /* Chat content padding adjustment */
+  .chat-content {
+    padding: 1.5rem;
+  }
+
+  /* Input bar area padding */
+  .input-bar-area {
+    padding: 0.75rem 1.25rem;
+  }
+}
+
+/* --- Milestone Toast Animations --- */
+@keyframes slideIn {
+  from {
+    transform: translateX(100%);
+    opacity: 0;
+  }
+
+  to {
+    transform: translateX(0);
+    opacity: 1;
+  }
+}
+
+@keyframes slideOut {
+  from {
+    transform: translateX(0);
+    opacity: 1;
+  }
+
+  to {
+    transform: translateX(100%);
+    opacity: 0;
+  }
+}
+
+.milestone-toast {
+  animation: slideIn 0.3s ease-out;
+}
+
+/* Milestone progress display in Continue Learning card */
+.milestone-progress {
+  display: flex;
+  align-items: center;
+  gap: 8px;
+  margin-top: 8px;
+  font-size: 0.85rem;
+  color: var(--text-secondary);
+}
+
+.milestone-progress .checkmarks {
+  display: flex;
+  gap: 4px;
+}
+
+.milestone-progress .checkmark {
+  width: 8px;
+  height: 8px;
+  border-radius: 50%;
+  background: var(--border);
+  transition: background 0.3s ease;
+}
+
+.milestone-progress .checkmark.completed {
+  background: var(--primary);
+}
+
+.milestone-progress .checkmark.completed::after {
+  content: 'Ô£ô';
+  font-size: 6px;
+  color: white;
+  display: flex;
+  align-items: center;
+  justify-content: center;
+}
\ No newline at end of file
